<!DOCTYPE html>

<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Portal Fluig - Cliente</title>
<style>
        /* Importa√ß√£o da fonte Roboto */
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap');

        /* Vari√°veis CSS para cores e sombras */
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --text-color: #333;
            --light-gray: #f8f9fa;
            --border-color: #dee2e6;
            --header-bg: #fff;
            --table-header-bg: #e9ecef;
            --shadow: 0 2px 4px rgba(0,0,0,0.05);
            --red-alert: #dc3545;
            --green-success: #28a745;
            --orange-warning: #ffc107;
            --colombia-bg: #e6f7ff;
            --hongkong-bg: #fff3e0;
            --colombia-border: #90cdf4;
            --hongkong-border: #ffcc80;
            --highlight-container-bg: #d1e7dd;
            --highlight-container-border: #28a745;
        }

        /* Reset b√°sico e estilo de fonte */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Roboto', sans-serif;
            color: var(--text-color);
        }

        body {
            background-color: var(--light-gray);
            line-height: 1.6;
            font-size: 14px;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Estilo para as telas do aplicativo */
        .page {
            display: none;
            width: 100%;
            flex-grow: 1;
        }

        .page.active {
            display: flex;
            flex-direction: column;
        }

        .hidden {
            display: none !important;
        }

        /* Estilo do cabe√ßalho */
        .header {
            background-color: var(--header-bg);
            padding: 15px 40px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
        }

        .header h1 {
            font-size: 20px;
            font-weight: 500;
            margin-bottom: 5px;
        }

        .header p {
            font-size: 13px;
            color: #666;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-icon {
            background-color: #e0e0e0;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            color: #666;
            cursor: pointer;
            flex-shrink: 0;
        }

        /* Estilos dos bot√µes */
        .btn-primary {
            background-color: var(--primary-color);
            color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background-color 0.2s ease-in-out;
            white-space: nowrap;
        }

        .btn-primary:hover {
            background-color: #0056b3;
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background-color 0.2s ease-in-out;
            white-space: nowrap;
        }

        .btn-secondary:hover {
            background-color: #5a6268;
        }

        /* Estilos dos grupos de input */
        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 13px;
            font-weight: 500;
            color: #555;
        }

        .input-group input[type="text"],
        .input-group input[type="password"],
        .input-group input[type="number"],
        .input-group input[type="file"],
        .input-group select,
        textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.2s ease-in-out;
        }

        .input-group input:focus,
        .input-group select:focus,
        textarea:focus {
            border-color: var(--primary-color);
        }

        /* √çcones */
        .icon-user::before { content: 'üë§'; }
        .icon-lock::before { content: 'üîí'; }
        .icon-search::before { content: 'üîç'; }
        .icon-plus::before { content: '‚ûï'; }
        .icon-question::before { content: '?'; }
        .icon-flow::before { content: '!'; }

        /* Cont√™iner principal de conte√∫do */
        .container {
            width: 100%;
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: var(--shadow);
            flex-grow: 1;
        }

        /* Filtros da tabela */
        .filters {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: var(--shadow);
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
            flex-grow: 1;
            min-width: 150px;
        }

        .filter-group label {
            font-weight: 500;
            color: #555;
            font-size: 13px;
            white-space: nowrap;
        }

        .filter-group select,
        .filter-group input {
            padding: 8px 10px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 14px;
            min-width: 120px;
        }

        .search-group {
            flex-grow: 2;
            display: flex;
            flex-direction: column;
            gap: 5px;
            min-width: 250px;
        }

        .search-input-wrapper {
            display: flex;
            width: 100%;
        }

        .search-group input {
            flex-grow: 1;
            border-right: none;
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }

        .search-icon-btn {
            background-color: transparent;
            border: 1px solid var(--border-color);
            border-left: none;
            border-radius: 0 5px 5px 0;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 16px;
            color: #666;
        }

        /* Estilos da tabela */
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            background-color: #fff;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        table thead th {
            background-color: var(--table-header-bg);
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
            font-size: 12px;
            color: #555;
            text-transform: uppercase;
            border-bottom: 1px solid var(--border-color);
            white-space: nowrap;
        }

        table tbody td {
            padding: 10px 15px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 13px;
            vertical-align: middle;
            white-space: nowrap;
        }

        table tbody tr:hover {
            background-color: #f5f5f5;
        }

        .pedido-link {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
        }

        .pedido-link:hover {
            text-decoration: underline;
        }

        .flag-icon {
            width: 16px;
            height: 11px;
            vertical-align: middle;
            margin-right: 5px;
            border: 1px solid #eee;
        }

        .footer-button {
            text-align: right;
            margin-top: 20px;
            padding: 10px 0;
        }

        /* Se√ß√µes de formul√°rio */
        .form-section {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        /* Abas */
        .tab-buttons {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 20px;
        }

        .tab-button {
            background-color: transparent;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.2s ease-in-out;
        }

        .tab-button.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        .tab-content {
            display: none;
            padding: 20px 0;
        }

        .tab-content.active {
            display: block;
        }

        .tab-content h2 {
            font-size: 18px;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .tab-content p {
            font-size: 13px;
            color: #666;
            margin-bottom: 15px;
        }

        /* Acorde√£o */
        .accordion {
            border: 1px solid var(--border-color);
            border-radius: 5px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .accordion-item {
            border-bottom: 1px solid var(--border-color);
        }

        .accordion-item:last-child {
            border-bottom: none;
        }

        .accordion-header {
            width: 100%;
            background-color: #f7f7f7;
            padding: 12px 15px;
            text-align: left;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.2s ease-in-out;
        }

        .accordion-header:hover {
            background-color: #ececec;
        }

        .accordion-header .arrow {
            transition: transform 0.2s ease-in-out;
        }

        .accordion-header.active .arrow {
            transform: rotate(180deg);
        }

        .accordion-content {
            padding: 15px;
            background-color: #fff;
            border-top: 1px solid var(--border-color);
            display: none;
        }

        .accordion-content.active {
            display: block;
        }

        #uploadPlanilhaInput,
        #copiarColarTextarea {
            margin-top: 10px;
            margin-bottom: 10px;
        }

        /* Grid de como usar */
        .how-to-use-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .how-to-use-item {
            background-color: #f0f5fa;
            border: 1px dashed #cce0f0;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .how-to-use-item h4 {
            font-size: 16px;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .how-to-use-item p {
            font-size: 13px;
            color: #555;
            margin-bottom: 15px;
        }

        .how-to-use-item a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
        }

        .how-to-use-item a:hover {
            text-decoration: underline;
        }

        /* Grid de adicionar produto */
        .add-product-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            align-items: end;
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            background-color: #fefefe;
        }

        .add-product-grid .input-group {
            margin-bottom: 0;
        }

        .add-product-grid .input-group input[type="text"],
        .add-product-grid .input-group input[type="number"],
        .add-product-grid .input-group select {
            width: 100%;
        }

        .add-product-grid .input-group.full-width {
            grid-column: span 2;
        }

        .add-product-grid .input-group.search-input {
            display: flex;
            align-items: center;
        }
        .add-product-grid .input-group.search-input input {
            border-right: none;
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }
        .add-product-grid .input-group.search-input button {
            border-left: none;
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
            padding: 10px 12px;
            height: 38px;
        }

        .add-button-container {
            grid-column: span 4;
            text-align: right;
            margin-top: 10px;
        }

        /* Se√ß√£o de produtos adicionados */
        .products-added-section {
            margin-top: 30px;
            border-top: 1px solid var(--border-color);
            padding-top: 20px;
        }

        .products-added-section h3 {
            font-size: 18px;
            margin-bottom: 15px;
            font-weight: 500;
        }

        #noProductsMessage {
            text-align: center;
            color: #888;
            padding: 20px;
            border: 1px dashed var(--border-color);
            border-radius: 5px;
        }

        #addedProductsTable {
            width: 100%;
            margin-top: 15px;
            table-layout: auto;
        }

        #addedProductsTable th,
        #addedProductsTable td {
            padding: 10px 8px;
            text-align: left;
            border: 1px solid #eee;
            font-size: 12px;
            word-wrap: break-word;
        }

        #addedProductsTable th {
            background-color: var(--table-header-bg);
            font-weight: 600;
            text-transform: uppercase;
            white-space: nowrap;
        }

        #addedProductsTable td {
            white-space: normal;
        }

        #addedProductsTable .remove-item-btn {
            background-color: var(--red-alert);
            color: #fff;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: background-color 0.2s ease-in-out;
        }

        #addedProductsTable .remove-item-btn:hover {
            background-color: #c82333;
        }

        /* A√ß√µes do formul√°rio */
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .product-details {
            display: none;
        }

        /* Mensagens de valida√ß√£o e status */
        .validation-message {
            color: var(--red-alert);
            font-size: 13px;
            margin-top: 10px;
            display: none;
        }

        .success-message {
            color: var(--green-success);
            font-size: 13px;
            margin-top: 10px;
            display: none;
        }

        .status-ok { color: var(--green-success); font-weight: bold; }
        .status-warning { color: var(--orange-warning); font-weight: bold; }
        .status-error { color: var(--red-alert); font-weight: bold; }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }
        .status-indicator.green { background-color: var(--green-success); }
        .status-indicator.yellow { background-color: var(--orange-warning); }
        .status-indicator.red { background-color: var(--red-alert); }
        .status-indicator.blue { background-color: var(--primary-color); }
        .status-indicator.gray { background-color: var(--secondary-color); }
        .status-indicator.purple { background-color: #800080; }

        /* Estilos de modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 600px;
            position: relative;
        }

        .modal-close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 24px;
            background: none;
            border: none;
            cursor: pointer;
            color: #888;
        }

        .modal-content h3 {
            margin-bottom: 20px;
            font-size: 20px;
            color: var(--primary-color);
        }

        .modal-content pre {
            background-color: var(--light-gray);
            padding: 15px;
            border-radius: 5px;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
        }

        .modal-content .modal-actions {
            margin-top: 25px;
            text-align: right;
        }

        #productCatalogModal .modal-content {
            max-width: 800px;
        }

        #productCatalogModal .modal-content .search-bar {
            margin-bottom: 15px;
            display: flex;
            gap: 10px;
        }

        #productCatalogModal .modal-content .search-bar input {
            flex-grow: 1;
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
        }

        #productCatalogModal .modal-content .product-catalog-table-container {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-radius: 5px;
        }

        #productCatalogModal .modal-content .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        #productCatalogModal .modal-content .data-table th,
        #productCatalogModal .modal-content .data-table td {
            padding: 10px;
            border-bottom: 1px solid #eee;
            text-align: left;
            font-size: 13px;
        }

        #productCatalogModal .modal-content .data-table th {
            background-color: #f7f7f7;
            font-weight: 600;
            text-transform: uppercase;
        }

        #productCatalogModal .modal-content .data-table tbody tr:hover {
            background-color: #f5f5f5;
            cursor: pointer;
        }

        /* Estilos espec√≠ficos para revis√£o e cards de filial */
        .needs-review {
            background-color: #fff3cd !important;
            border: 1px solid #ffc107 !important;
        }

        .summary-section {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .summary-section:last-child {
            border-bottom: none;
            padding-bottom: 0;
            margin-bottom: 0;
        }

        .summary-section h2 {
            font-size: 22px;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        .supplier-summary-card {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            position: relative;
        }

        .supplier-status-indicator {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
        }

        .price-difference-positive {
            color: var(--red-alert);
            font-weight: bold;
        }

        .price-difference-negative {
            color: var(--green-success);
            font-weight: bold;
        }

        /* Grid de detalhes */
        .details-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px 20px;
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 0;
            border-bottom: 1px dashed #e9ecef;
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-weight: 500;
            color: #555;
            flex-basis: 40%;
            text-align: left;
        }

        .detail-value {
            font-weight: 600;
            color: #333;
            flex-basis: 60%;
            text-align: right;
            display: flex;
            justify-content: flex-end;
            align-items: center;
        }

        /* Rastreamento de etapas */
        .tracking-steps {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 20px 0;
            position: relative;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: var(--shadow);
            overflow-x: auto;
            white-space: nowrap;
            min-height: 120px;
        }

        .tracking-steps::before {
            content: '';
            position: absolute;
            top: 40px;
            left: 20px;
            right: 20px;
            height: 2px;
            background-color: #e0e0e0;
            z-index: 1;
        }

        .tracking-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            min-width: 100px;
            position: relative;
            z-index: 2;
            padding: 0 10px;
        }

        .tracking-step .circle {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #e0e0e0;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            color: #666;
            margin-bottom: 10px;
            flex-shrink: 0;
        }

        .tracking-step span {
            font-size: 12px;
            text-align: center;
            color: #666;
            word-wrap: break-word;
            white-space: normal;
        }

        .tracking-step.completed .circle {
            background-color: var(--green-success);
            color: #fff;
        }
        .tracking-step.active .circle {
            background-color: var(--primary-color);
            color: #fff;
            border: 2px solid var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.3);
        }
        .tracking-step.pending .circle {
            background-color: var(--orange-warning);
            color: #fff;
        }
        .tracking-step.rejected .circle,
        .tracking-step.cancelled .circle {
            background-color: var(--red-alert);
            color: #fff;
        }
        .tracking-step.approved .circle,
        .tracking-step.production .circle,
        .tracking-step.ready-cargo .circle,
        .tracking-step.atd .circle,
        .tracking-step.pending-doc .circle,
        .tracking-step.doc-ok .circle,
        .tracking-step.ata .circle,
        .tracking-step.finished .circle {
            background-color: var(--green-success);
            color: #fff;
        }
        .tracking-step.negotiation .circle,
        .tracking-step.waiting-approval .circle {
            background-color: var(--orange-warning);
            color: #fff;
        }
        .tracking-step.separation .circle,
        .tracking-step.conference .circle,
        .tracking-step.in-transit .circle,
        .tracking-step.delivered .circle {
            background-color: var(--primary-color);
            color: #fff;
        }

        .tracking-step.completed span {
            color: #333;
            font-weight: 500;
        }
        .tracking-step.active span {
            color: var(--primary-color);
            font-weight: bold;
        }
        .tracking-step.rejected span,
        .tracking-step.cancelled span {
            color: var(--red-alert);
            font-weight: bold;
        }

        /* Estilos de coluna espec√≠ficos por pa√≠s */
        .colombia-col {
            background-color: var(--colombia-bg);
            border-left: 1px solid var(--colombia-border);
            border-right: 1px solid var(--colombia-border);
        }

        .hongkong-col {
            background-color: var(--hongkong-bg);
            border-left: 1px solid var(--hongkong-border);
            border-right: 1px solid var(--hongkong-border);
        }

        /* Tabela de cubagem */
        .cubage-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            margin-bottom: 20px;
        }

        .cubage-table th,
        .cubage-table td {
            border: 1px solid var(--border-color);
            padding: 3px 5px;
            text-align: left;
            font-size: 11px;
        }

        .cubage-table th {
            background-color: var(--table-header-bg);
            font-weight: 600;
            text-transform: uppercase;
        }

        .cubage-table tr.highlight-container {
            background-color: var(--highlight-container-bg);
            border: 1px solid var(--highlight-container-border);
            font-weight: bold;
        }

        /* Modal de fluxograma */
        #flowchartModal .modal-content {
            max-width: 90%;
            width: auto;
            padding: 15px;
        }

        #flowchartImage {
            max-width: 100%;
            height: auto;
            display: block;
            background-color: transparent;
            border: none;
            object-fit: contain;
        }

        /* Cont√™iner de compara√ß√£o de filiais */
        .branch-comparison-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
            justify-content: center;
        }

        .branch-card {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            flex: 1 1 calc(50% - 20px);
            min-width: 300px;
            border: 1px solid var(--border-color);
        }

        .branch-card h3 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .branch-card .flag-icon-large {
            width: 30px;
            height: 20px;
            border: 1px solid #eee;
            flex-shrink: 0;
        }

        .colombia-card {
            border-left: 5px solid var(--colombia-border);
            background-color: var(--colombia-bg);
        }

        .hongkong-card {
            border-left: 5px solid var(--hongkong-border);
            background-color: var(--hongkong-bg);
        }

        .branch-card p {
            font-size: 13px;
            margin-bottom: 10px;
        }

        .branch-card .delivery-time {
            font-weight: bold;
            color: var(--primary-color);
        }

        .branch-card .price-model h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .branch-card .price-model ul {
            list-style-type: disc;
            margin-left: 20px;
            margin-bottom: 10px;
        }

        .branch-card .price-model ul li {
            font-size: 13px;
            margin-bottom: 3px;
        }

        .branch-card .stock-info,
        .branch-card .moq-info {
            font-style: italic;
            color: #666;
        }

        .disclaimer-text {
            font-size: 12px;
            color: #888;
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px dashed #eee;
            text-align: center;
        }

        /* Media queries para responsividade */
        @media (max-width: 768px) {
            .branch-card {
                flex: 1 1 100%;
            }
        }
    </style>
</head>
<body>
<!-- Tela da Central de Pedidos -->
<div class="page active" id="central-pedidos-page">
<header class="header">
<div class="header-left">
<h1 data-translate="centralOrdersTitle">Central de Pedidos</h1>
</div>
<div class="header-right">
<select class="p-2 border rounded-md text-sm" id="language-selector-central" onchange="setLanguage(this.value)">
<option value="pt-BR">Portugu√™s</option>
<option value="en">English</option>
<option value="es">Espa√±ol</option>
</select>
<button class="btn-primary" data-translate="newRequestButton" id="novaSolicitacao"><i class="icon-plus"></i> Nova Solicita√ß√£o</button>
<span class="header-icon" onclick="showScreenInfo()"><i class="icon-question"></i></span>
<span class="header-icon" onclick="openFlowchartModal()"><i class="icon-flow"></i></span>
<button class="btn-secondary" data-translate="logoutButton" id="logoutButton">Sair (Logout)</button>
</div>
</header>
<div class="container">
<div class="filters">
<div class="filter-group">
<label data-translate="statusFilterLabel" for="status">Status:</label>
<select id="status" onchange="renderOrdersTable()">
<option data-translate="allOption" value="Todos">Todos</option>
<option data-translate="statusPending" value="Pendente">Pendente</option>
<option data-translate="statusApproved" value="Aprovado">Aprovado</option>
<option data-translate="statusRejected" value="Rejeitado">Rejeitado</option>
<option data-translate="statusInConference" value="Em Confer√™ncia">Em Confer√™ncia</option>
<option data-translate="statusDelivered" value="Entregue">Entregue</option>
<option data-translate="statusCargoReady" value="Carga Pronta">Carga Pronta</option>
<option data-translate="statusInDeliveryRoute" value="Em Rota de Entrega">Em Rota de Entrega</option>
<option data-translate="statusATD" value="Sa√≠da do Porto de Embarque (ATD)">Sa√≠da do Porto de Embarque (ATD)</option>
<option data-translate="statusATA" value="Chegada no Porto de Destino (ATA)">Chegada no Porto de Destino (ATA)</option>
<option data-translate="statusCancelled" value="Cancelado">Cancelado</option>
</select>
</div>
<div class="filter-group">
<label data-translate="supplierFilterLabel" for="fornecedor">Fornecedor:</label>
<select id="fornecedor" onchange="renderOrdersTable()">
<option data-translate="allOption" value="Todos">Todos</option>
</select>
</div>
<div class="filter-group">
<label data-translate="originCountryFilterLabel" for="paisOrigem">Pa√≠s Origem:</label>
<select id="paisOrigem" onchange="renderOrdersTable()">
<option data-translate="allOption" value="Todos">Todos</option>
</select>
</div>
<div class="filter-group search-group">
<label data-translate="searchLabel" for="search">Buscar por N¬∫ Pedido ou Cliente:</label>
<div class="search-input-wrapper">
<input data-translate-placeholder="searchPlaceholder" id="search" placeholder="Buscar por N¬∫ Pedido ou Cliente" type="text"/>
<button class="search-icon-btn" onclick="renderOrdersTable()"><i class="icon-search"></i></button>
</div>
</div>
</div>
<div class="table-container">
<table>
<thead>
<tr>
<th data-translate="colMainRequestId">ID SOLICITA√á√ÉO PRINCIPAL</th>
<th data-translate="colOrderNumber">N¬∫ PEDIDO</th>
<th data-translate="colOrigin">ORIGEM</th>
<th data-translate="colOriginCountry">PA√çS ORIGEM</th>
<th data-translate="colSupplier">FORNECEDOR</th>
<th data-translate="colTotalValue">VALOR TOTAL</th>
<th data-translate="colOrderStatus">STATUS DO PEDIDO</th>
<th data-translate="colRequestDate">DATA SOLICITA√á√ÉO/CRIA√á√ÉO</th>
<th data-translate="colLastChangeDate">DATA √öLTIMA ALTERA√á√ÉO</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
<!-- Tela de Detalhes do Pedido -->
<div class="page" id="orderDetailsScreen">
<header class="header">
<div class="header-left">
<h1 data-translate="orderDetailsTitle">Detalhes do Pedido <span id="currentOrderId"></span></h1>
</div>
<div class="header-right">
<select class="p-2 border rounded-md text-sm" id="language-selector-details" onchange="setLanguage(this.value)">
<option value="pt-BR">Portugu√™s</option>
<option value="en">English</option>
<option value="es">Espa√±ol</option>
</select>
<span class="header-icon" onclick="showScreenInfo()"><i class="icon-question"></i></span>
<span class="header-icon" onclick="openFlowchartModal()"><i class="icon-flow"></i></span>
</div>
</header>
<div class="container">
<div class="form-section">
<h2 class="text-xl font-semibold mb-4" data-translate="generalInfoTitle">Informa√ß√µes Gerais</h2>
<div class="details-grid">
<div class="detail-row">
<div class="detail-label" data-translate="orderNumberLabel">N¬∫ Pedido:</div>
<div class="detail-value" id="detailOrderId"></div>
</div>
<div class="detail-row">
<div class="detail-label" data-translate="mainIdLabel">ID Principal:</div>
<div class="detail-value" id="detailParentOrderId"></div>
</div>
<div class="detail-row">
<div class="detail-label" data-translate="originLabel">Origem:</div>
<div class="detail-value" id="detailOriginDisplay"></div>
</div>
<div class="detail-row">
<div class="detail-label" data-translate="supplierLabel">Fornecedor:</div>
<div class="detail-value" id="detailSupplier"></div>
</div>
<div class="detail-row">
<div class="detail-label" data-translate="totalValueLabel">Valor Total:</div>
<div class="detail-value" id="detailTotalValue"></div>
</div>
<div class="detail-row">
<div class="detail-label" data-translate="freightLabel">FREIGHT:</div>
<div class="detail-value" id="detailFreight"></div>
</div>
<div class="detail-row">
<div class="detail-label" data-translate="orderStatusLabel">Status do Pedido:</div>
<div class="detail-value" id="detailStatus"></div>
</div>
<div class="detail-row">
<div class="detail-label" data-translate="requestCreationDateLabel">Data Solicita√ß√£o/Cria√ß√£o:</div>
<div class="detail-value" id="detailRequestDate"></div>
</div>
<div class="detail-row">
<div class="detail-label" data-translate="lastChangeDateLabel">Data √öltima Altera√ß√£o:</div>
<div class="detail-value" id="detailLastUpdateDate"></div>
</div>
</div>
</div>
<div class="form-section">
<h2 class="text-xl font-semibold mb-4" data-translate="trackingStatusTitle">Status de Rastreamento</h2>
<div class="relative flex justify-between items-center my-8 p-4 bg-gray-50 rounded-lg shadow-inner" id="orderTrackingSection">
</div>
</div>
<div class="form-section">
<h2 class="text-xl font-semibold mb-4" data-translate="orderProductsTitle">Produtos do Pedido</h2>
<div class="table-container">
<table class="w-full">
<thead>
<tr>
<th data-translate="colProductCode">C√≥digo Produto</th>
<th data-translate="colDescription">Descri√ß√£o</th>
<th data-translate="colQuantity">Quantidade</th>
<th data-translate="colUnitPrice">Valor Unit√°rio</th>
<th data-translate="colTotalItemValue">Valor Total Item</th>
</tr>
</thead>
<tbody id="orderDetailsProductsTableBody">
</tbody>
</table>
</div>
</div>
<div class="form-actions">
<button class="btn-secondary" data-translate="backToOrderCenterButton" onclick="backToOrderCenter()">Voltar para Central de Pedidos</button>
<button class="btn-secondary" data-translate="CenterButton2" onclick="window.location.href='tracking.html'">Tracking</button>
</div>
</div>
</div>
<!-- Tela de Nova Solicita√ß√£o de Compra -->
<div class="page" id="newOrderFormScreen">
<header class="header">
<div class="header-left">
<h1 data-translate="newPurchaseRequestTitle">Nova Solicita√ß√£o de Compra</h1>
<p data-translate="newPurchaseRequestSubtitle">Por favor, preencha os detalhes dos produtos desejados.</p>
</div>
<div class="header-right">
<select class="p-2 border rounded-md text-sm" id="language-selector-new-request" onchange="setLanguage(this.value)">
<option value="pt-BR">Portugu√™s</option>
<option value="en">English</option>
<option value="es">Espa√±ol</option>
</select>
<span class="header-icon" onclick="showScreenInfo()"><i class="icon-question"></i></span>
<span class="header-icon" onclick="openFlowchartModal()"><i class="icon-flow"></i></span>
</div>
</header>
<div class="container">
<div class="form-section">
<label data-translate="clientOrderNumberLabel" for="clientOrderNumber">N√∫mero do Pedido do Cliente (Opcional)</label>
<input data-translate-placeholder="clientOrderNumberPlaceholder" id="clientOrderNumber" placeholder="Seu n√∫mero de refer√™ncia do pedido" type="text"/>
</div>
<div class="tab-buttons" id="orderFormTabButtons">
<button class="tab-button active" data-translate="easyOrderTab" onclick="switchOrderFormTab('easy')">Pedido F√°cil</button>
<button class="tab-button" data-translate="manualOrderTab" onclick="switchOrderFormTab('manual')">Pedido Manual</button>
</div>
<div class="tab-content active" id="easyOrderTab">
<h2 data-translate="easyOrderTitle">Pedido F√°cil</h2>
<p data-translate="easyOrderSubtitle">Escolha uma das op√ß√µes abaixo para adicionar os produtos ao carrinho de compras</p>
<div class="accordion">
<div class="accordion-item">
<button class="accordion-header" data-translate="uploadSpreadsheetHeader" onclick="toggleCollapsible(this, 'uploadPlanilhaContent')">Upload de Planilha <span class="arrow">‚ñº</span></button>
<div class="accordion-content" id="uploadPlanilhaContent">
<input accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" id="fileUpload" onchange="displayFileName('fileUpload', 'fileNameDisplay')" type="file"/>
<span class="text-sm text-gray-500 ml-2" data-translate="noFileSelected" id="fileNameDisplay">Nenhum arquivo selecionado</span>
<button class="btn-primary mt-2" data-translate="uploadButton" onclick="handleFileUpload()">Fazer Upload</button>
<p class="text-xs text-gray-500 mt-2" data-translate="uploadLimitInfo">Limite de 50 linhas de produtos e 5MB de tamanho.</p>
</div>
</div>
<div class="accordion-item">
<button class="accordion-header" data-translate="pasteCodesHeader" onclick="toggleCollapsible(this, 'pasteCodesContent')">Copiar e Colar C√≥digos <span class="arrow">‚ñº</span></button>
<div class="accordion-content" id="pasteCodesContent">
<textarea data-translate-placeholder="pasteCodesPlaceholder" id="pasteCodes" placeholder="Cole aqui os c√≥digos e quantidades (Ex: COD1,10;COD2,5 ou COD1,10 ENTER COD2,5)" rows="10"></textarea>
<button class="btn-primary mt-2" data-translate="processCodesButton" onclick="processPastedCodes()">Processar C√≥digos Colados</button>
<div class="validation-message" id="addProductMessage"></div>
</div>
</div>
</div>
<h3 data-translate="howToUseSpreadsheetTitle">Saiba como utilizar nosso modelo de planilha</h3>
<div class="how-to-use-grid">
<div class="how-to-use-item">
<h4 data-translate="step1Title">Passo 1</h4>
<p data-translate="step1Description">Fa√ßa o download do modelo de planilha. Abra a planilha no seu computador e preencha com o c√≥digo do produto do cliente e a quantidade desejada. M√°ximo de 50 linhas de produtos por pedido.</p>
<a data-translate="spreadsheetModelLink" href="#" id="downloadModeloPlanilha" onclick="downloadSpreadsheetModel()">Modelo de Planilha</a>
</div>
<div class="how-to-use-item">
<h4 data-translate="step2Title">Passo 2</h4>
<p data-translate="step2Description">Com sua planilha pronta e salva no seu computador, clique em Selecionar arquivo. Em seguida, clique em Fazer upload. O tamanho da planilha n√£o deve ultrapassar 5MB de tamanho.</p>
</div>
<div class="how-to-use-item">
<h4 data-translate="step3Title">Passo 3</h4>
<p data-translate="step3Description">Com sua planilha pronta e salva no seu computador, clique em Selecionar arquivo. Em seguida, clique em Fazer upload. O tamanho da planilha n√£o deve ultrapassar 5MB de tamanho.</p>
</div>
</div>
</div>
<div class="tab-content" id="manualOrderTab">
<h2 data-translate="addProductsTitle">Adicionar Produtos</h2>
<div class="add-product-grid">
<div class="input-group search-input">
<label data-translate="clientProductCodeLabel" for="clientProductCode">C√≥d Prod Cliente:</label>
<input data-translate-placeholder="clientProductCodePlaceholder" id="clientProductCode" oninput="updateProductDetailsOnClientCodeChange()" placeholder="C√≥d Cliente" type="text"/>
<button class="btn-secondary" onclick="openProductCatalogModal()"><i class="icon-search"></i></button>
</div>
<div class="input-group">
<label data-translate="productCodeLabel" for="mappedProductCodeDisplay">C√≥d Produto:</label>
<input id="mappedProductCodeDisplay" readonly="" type="text" value="--"/>
</div>
<div class="input-group full-width">
<label data-translate="descriptionLabel" for="productDescriptionDisplay">Descri√ß√£o:</label>
<input id="productDescriptionDisplay" readonly="" type="text" value="--"/>
</div>
<div class="input-group">
<label data-translate="quantityLabel" for="productQuantity">Quantidade:</label>
<input id="productQuantity" min="1" oninput="handleQuantityChange()" type="number" value="1"/>
<div class="text-xs mt-1" id="validationFeedback"></div>
</div>
<div class="input-group" id="productValueGroup">
<label data-translate="unitValueLabel" for="productValueDisplay">Valor Unit.:</label>
<input id="productValueDisplay" readonly="" type="text" value="$ 0,00"/>
</div>
<div class="input-group" id="totalM3Group">
<label data-translate="totalM3Label" for="totalM3Display">M¬≥ Total:</label>
<input id="totalM3Display" readonly="" type="text" value="0.00 m¬≥"/>
</div>
<div class="input-group" id="valorTotalGroup">
<label data-translate="totalValueLabel" for="valorTotalDisplay">Valor Total:</label>
<input id="valorTotalDisplay" readonly="" type="text" value="$ 0,00"/>
</div>
<div class="input-group" id="productStockGroup">
<label data-translate="stockLabel" for="productStockDisplay">Estoque:</label>
<input id="productStockDisplay" readonly="" type="text" value="--"/>
</div>
<div class="add-button-container">
<button class="btn-primary" data-translate="addProductButton" id="addProductBtn" onclick="addProduct()">Adicionar Produto</button>
</div>
</div>
<div class="validation-message" id="addProductMessage"></div>
</div>
<div class="products-added-section">
<h3 class="font-semibold text-gray-700 mb-4" data-translate="branchDifferencesTitle">Diferen√ßas de Compra por Filial:</h3>
<div class="branch-comparison-container">
<div class="branch-card colombia-card">
<h3 data-translate="colombiaBranchTitle"><img alt="Bandeira da Col√¥mbia" class="flag-icon-large" src="https://e7.pngegg.com/pngimages/796/10/png-clipart-flag-of-colombia-flag-of-cambodia-colombia-flag-flag-sphere-thumbnail.png"/> Col√¥mbia</h3>
<p class="delivery-time" data-translate="colombiaDeliveryTime">Previs√£o de Entrega: ~45 dias</p>
<div class="price-model">
<h4 data-translate="priceModelTitle">Modelo de Pre√ßo:</h4>
<ul>
<li data-translate="colombiaPriceModelDesc">Pre√ßo √∫nico para produtos dispon√≠veis em estoque.</li>
</ul>
</div>
<p class="stock-info" data-translate="colombiaStockInfo">Foco em produtos com estoque dispon√≠vel.</p>
</div>
<div class="branch-card hongkong-card">
<h3 data-translate="hongKongBranchTitle"><img alt="Bandeira de Hong Kong" class="flag-icon-large" src="https://e7.pngegg.com/pngimages/630/750/png-clipart-flag-of-china-association-of-southeast-asian-nations-national-flag-asean%E3%81%AE%E7%B4%8B%E7%AB%A0-china-orange-world-thumbnail.png"/> Hong Kong</h3>
<p class="delivery-time" data-translate="hongKongDeliveryTime">Previs√£o de Entrega: ~90 dias</p>
<div class="price-model">
<h4 data-translate="priceModelTitle">Modelo de Pre√ßo:</h4>
<ul>
<li data-translate="hongKongPriceModelLCL"><strong>LCL:</strong> Mais caro (para volumes pequenos)</li>
<li data-translate="hongKongPriceModel20ft"><strong>Container 20ft:</strong> Pre√ßo intermedi√°rio</li>
<li data-translate="hongKongPriceModel40ft"><strong>Container 40ft:</strong> Mais barato (para volumes maiores)</li>
</ul>
</div>
<p class="moq-info" data-translate="hongKongMOQInfo">Para adquirir, √© necess√°rio atender ao MOQ (Quantidade M√≠nima de Pedido).</p>
</div>
</div>
<div id="productList">
</div>
</div>
<div class="form-actions">
<button class="btn-secondary" data-translate="backButton" onclick="backToOrderCenter()">Voltar</button>
<button class="btn-primary" data-translate="submitRequestButton" onclick="submitOrderForm()">Enviar Solicita√ß√£o</button>
</div>
</div>
</div>
<!-- Tela de Resumo da Solicita√ß√£o -->
<div class="page" id="summaryScreen">
<header class="header">
<div class="header-left">
<h1 data-translate="requestSummaryTitle">Resumo da Solicita√ß√£o</h1>
<p data-translate="requestSummarySubtitle">Confira a divis√£o dos produtos por filial e fornecedor.</p>
</div>
<div class="header-right">
<select class="p-2 border rounded-md text-sm" id="language-selector-summary" onchange="setLanguage(this.value)">
<option value="pt-BR">Portugu√™s</option>
<option value="en">English</option>
<option value="es">Espa√±ol</option>
</select>
<span class="header-icon" onclick="showScreenInfo()"><i class="icon-question"></i></span>
<span class="header-icon" onclick="openFlowchartModal()"><i class="icon-flow"></i></span>
</div>
</header>
<div class="container">
<div id="unifiedSummaryContent">
</div>
<div class="form-actions">
<button class="btn-secondary" data-translate="backAndAdjustButton" onclick="backToProductEntry()">Voltar e Ajustar</button>
<button class="btn-primary" data-translate="confirmAndGenerateButton" onclick="confirmAndGenerateOrders()">Confirmar e Gerar Pedidos</button>
</div>
</div>
</div>
<!-- Tela de Ordem de Compra Gerada -->
<div class="page" id="purchaseOrderScreen">
<header class="header">
<div class="header-left">
<h1 data-translate="requestGeneratedSuccessTitle">Solicita√ß√£o Gerada com Sucesso!</h1>
<p data-translate="requestGeneratedSuccessSubtitle">Sua solicita√ß√£o foi enviada para o time de Compras Internacionais.</p>
</div>
<div class="header-right">
<select class="p-2 border rounded-md text-sm" id="language-selector-po" onchange="setLanguage(this.value)">
<option value="pt-BR">Portugu√™s</option>
<option value="en">English</option>
<option value="es">Espa√±ol</option>
</select>
<span class="header-icon" onclick="showScreenInfo()"><i class="icon-question"></i></span>
<span class="header-icon" onclick="openFlowchartModal()"><i class="icon-flow"></i></span>
</div>
</header>
<div class="container">
<div class="form-section">
<h2 class="text-xl font-semibold mb-4" data-translate="poDetailsTitle">Detalhes da Ordem de Compra (PO)</h2>
<div class="bg-gray-50 p-4 rounded-lg border border-gray-200" id="poDetails">
</div>
</div>
<div class="form-actions">
<button class="btn-primary" data-translate="backToOrderCenterButton" onclick="backToOrderCenter()"></button>
<button class="btn-primary" data-translate="CenterButton2" onclick="backToOrderCenter()"></button>

</div>
</div>
</div>
<!-- Modais Gen√©ricos -->
<div class="modal-overlay" id="messageModal">
<div class="modal-content">
<button class="modal-close-btn" id="messageModalCloseBtn">√ó</button>
<h3 id="messageModalTitle"></h3>
<div id="messageModalContent"></div>
<div class="modal-actions">
<button class="btn-primary" data-translate="okButton" id="messageModalConfirmBtn">OK</button>
<button class="btn-secondary" data-translate="cancelButton" id="messageModalCancelBtn">Cancelar</button>
</div>
</div>
</div>
<div class="modal-overlay" id="summaryModal">
<div class="modal-content">
<button class="modal-close-btn" onclick="document.getElementById('summaryModal').classList.remove('active');">√ó</button>
<h3 data-translate="requestSummaryTitle">Resumo da Solicita√ß√£o</h3>
<pre id="summaryContent"></pre>
<div class="modal-actions">
<button class="btn-primary" data-translate="okButton" id="modalConfirmBtn" onclick="document.getElementById('summaryModal').classList.remove('active');">OK</button>
</div>
</div>
</div>
<div class="modal-overlay" id="productCatalogModal">
<div class="modal-content">
<button class="modal-close-btn" onclick="closeProductCatalogModal()">√ó</button>
<h3 data-translate="productCatalogTitle">Cat√°logo de Produtos</h3>
<div class="search-bar">
<input data-translate-placeholder="searchCatalogPlaceholder" id="productCatalogSearchInput" onkeyup="filterProductCatalog()" placeholder="Buscar por c√≥digo ou descri√ß√£o..." type="text"/>
<button class="btn-primary" data-translate="searchButton" onclick="filterProductCatalog()">Buscar</button>
</div>
<div class="product-catalog-table-container">
<div id="productCatalogList">
</div>
</div>
<div class="modal-actions">
<button class="btn-secondary" data-translate="closeButton" onclick="closeProductCatalogModal()">Fechar</button>
</div>
</div>
</div>
<div class="modal-overlay" id="nfePdfViewer">
<div class="modal-content">
<button class="modal-close-btn" onclick="document.getElementById('nfePdfViewer').classList.remove('active');">√ó</button>
<h3 data-translate="viewNFeTitle">Visualizar NF-e</h3>
<pre class="whitespace-pre-wrap" id="nfePdfContent"></pre>
<div class="modal-actions">
<button class="btn-primary" data-translate="closeButton" onclick="document.getElementById('nfePdfViewer').classList.remove('active');">Fechar</button>
</div>
</div>
</div>
<div class="modal-overlay" id="poPdfViewer">
<div class="modal-content">
<button class="modal-close-btn" onclick="document.getElementById('poPdfViewer').classList.remove('active');">√ó</button>
<h3 data-translate="viewPOPdfTitle">Visualizar PDF da PO</h3>
<pre class="whitespace-pre-wrap" id="poPdfContent"></pre>
<div class="modal-actions">
<button class="btn-primary" data-translate="closeButton" onclick="document.getElementById('poPdfViewer').classList.remove('active');">Fechar</button>
</div>
</div>
</div>
<div class="modal-overlay" id="flowchartModal">
<div class="modal-content">
<span class="modal-close-btn" onclick="closeFlowchartModal()">√ó</span>
<img alt="Fluxograma do Processo" id="flowchartImage" src="https://raw.githubusercontent.com/SamuelJuniorrr/importexport/refs/heads/main/fluxograma.png"/>
</div>
</div>
<script>
        // Vari√°veis de estado globais
        let currentScreen = 'central-pedidos-page';
        let productsInCurrentOrder = [];
        let simulatedSupplierOrders = {};
        let simulatedColombiaOrder = null;
        let currentOrderDetails = null;
        let currentUserClientName = "Cliente Mexico";
        let currentParentOrderId = null;
        let currentViewingPO = null;
        let currentPurchasingPO = null;

        // Constantes para c√°lculo de cubagem
        const LCL_CAPACITY = 20.0;
        const MAX_CUBAGE_20HC = 33.2;
        const MAX_CUBAGE_40HC = 67.7;
        const MAX_CUBAGE_40HC_CU = 76.0;

        // Banco de dados de produtos simulado
        const productDatabase = {
            "PROD001": { code: "PROD001", clientCode: "SKU-001", description: "Smartphone Premium X1", moq: 3, unitPrice: 150.00, tableValue: 160.00, cubageUnit: 3.5, simulatedStock: 100, productLine: "Eletr√¥nicos", supplier: "Fornecedor A", originCountry: "Hong Kong" },
            "PROD002": { code: "PROD002", clientCode: "SKU-002", description: "Tablet Pro Z", moq: 2, unitPrice: 250.00, tableValue: 265.00, cubageUnit: 5.0, simulatedStock: 50, productLine: "Eletr√¥nicos", supplier: "Fornecedor B", originCountry: "Hong Kong" },
            "PROD003": { code: "PROD003", clientCode: "SKU-003", description: "Fone Bluetooth Max", moq: 5, unitPrice: 45.00, tableValue: 50.00, cubageUnit: 1.0, simulatedStock: 200, productLine: "Acess√≥rios", supplier: "Fornecedor C", originCountry: "Col√¥mbia" },
            "PROD004": { code: "PROD004", clientCode: "SKU-004", description: "Smartwatch Sport Y", moq: 1, unitPrice: 80.00, tableValue: 85.00, cubageUnit: 0.002, simulatedStock: 120, productLine: "Vest√≠veis", supplier: "Fornecedor A", originCountry: "Hong Kong" },
            "PROD005": { code: "PROD005", clientCode: "SKU-005", description: "C√¢mera Digital Ultra HD", moq: 2, unitPrice: 300.00, tableValue: 320.00, cubageUnit: 0.01, simulatedStock: 30, productLine: "Fotografia", supplier: "Fornecedor B", originCountry: "Hong Kong" },
            "PROD006": { code: "PROD006", clientCode: "SKU-006", description: "Bateria Port√°til Mega", moq: 10, unitPrice: 25.00, tableValue: 28.00, cubageUnit: 0.0005, simulatedStock: 300, productLine: "Acess√≥rios", supplier: "Fornecedor C", originCountry: "Col√¥mbia" },
            "PROD007": { code: "PROD007", clientCode: "SKU-007", description: "Cadeira Ergon√¥mica", moq: 1, unitPrice: 600.00, tableValue: 650.00, cubageUnit: 18.0, simulatedStock: 15, productLine: "M√≥veis de Escrit√≥rio", supplier: "Fornecedor A", originCountry: "Hong Kong" },
            "PROD008": { code: "PROD008", clientCode: "SKU-008", description: "Impressora 3D Industrial", moq: 1, unitPrice: 800.00, tableValue: 850.00, cubageUnit: 30.0, simulatedStock: 0, productLine: "Maquin√°rio", supplier: "Fornecedor B", originCountry: "Hong Kong" },
            "PROD009": { code: "PROD009", clientCode: "SKU-009", description: "Monitor Ultrawide", moq: 1, unitPrice: 350.00, tableValue: 350.00, cubageUnit: 0.05, simulatedStock: 50, productLine: "Perif√©ricos", supplier: "Fornecedor C", originCountry: "Col√¥mbia" },
            "PROD010": { code: "PROD010", clientCode: "SKU-010", description: "Teclado Mec√¢nico", moq: 1, unitPrice: 80.00, tableValue: 80.00, cubageUnit: 0.01, simulatedStock: 75, productLine: "Perif√©ricos", supplier: "Fornecedor A", originCountry: "Hong Kong" },
            "PROD011": { code: "PROD011", clientCode: "SKU-011", description: "Mouse Gamer", moq: 1, unitPrice: 40.00, tableValue: 40.00, cubageUnit: 0.001, simulatedStock: 150, productLine: "Perif√©ricos", supplier: "Fornecedor B", originCountry: "Hong Kong" }
        };

        // Mapeamento de c√≥digo de cliente para c√≥digo de produto
        const universalClientCodeToProductCodeMap = {};
        for (const prodCode in productDatabase) {
            const product = productDatabase[prodCode];
            if (product.clientCode) {
                universalClientCodeToProductCodeMap[product.clientCode.toUpperCase()] = prodCode;
            }
        }

        // Mapeamento e gera√ß√£o de c√≥digos de fornecedor
        const supplierCodeMap = {};
        const supplierNameMap = {};
        let nextSupplierCode = 22;

        const clientNames = ["Cliente Mexico", "Cliente Chile", "Cliente Paraguai", "Cliente Colombia"];
        let clientIndex = 0;

        function assignClientName(originCountry) {
            let assignedClient = clientNames[clientIndex % clientNames.length];
            if (originCountry === 'Col√¥mbia' && assignedClient === 'Cliente Colombia') {
                clientIndex++;
                assignedClient = clientNames[clientIndex % clientNames.length];
            }
            clientIndex++;
            return assignedClient;
        }

        // Fluxos de rastreamento para Hong Kong e Col√¥mbia
        const hongKongTrackingFlow = [
            { nameKey: 'statusPending', class: 'pending' },
            { nameKey: 'statusNegotiation', class: 'negotiation' },
            { nameKey: 'statusWaitingApproval', class: 'waiting-approval' },
            { nameKey: 'statusRejected', class: 'rejected', isFinal: true },
            { nameKey: 'statusCancelled', class: 'cancelled', isFinal: true },
            { nameKey: 'statusApproved', class: 'approved' },
            { nameKey: 'statusProduction', class: 'production' },
            { nameKey: 'statusCargoReady', class: 'ready-cargo' },
            { nameKey: 'statusATD', class: 'atd' },
            { nameKey: 'statusPendingDoc', class: 'pending-doc' },
            { nameKey: 'statusDocOk', class: 'doc-ok' },
            { nameKey: 'statusATA', class: 'ata', isFinal: true },
            { nameKey: 'statusFinished', class: 'finished', isFinal: true }
        ];

        const colombiaTrackingFlow = [
            { nameKey: 'statusPending', class: 'pending' },
            { nameKey: 'statusSeparation', class: 'separation' },
            { nameKey: 'statusInConference', 'class': 'conference' },
            { nameKey: 'statusInDeliveryRoute', class: 'in-transit' },
            { nameKey: 'statusDelivered', class: 'delivered', isFinal: true },
            { nameKey: 'statusApproved', class: 'approved' },
            { nameKey: 'statusRejected', class: 'rejected', isFinal: true },
            { nameKey: 'statusCancelled', class: 'cancelled', isFinal: true }
        ];

        // Ordens de compra geradas inicialmente (dados simulados)
        const initialGeneratedPurchaseOrders = [
            {
                parentOrderId: 'SOL-001', id: 'PED-001', supplier: 'Fornecedor A', supplierCode: '22', date: '2025-06-20',
                products: [
                    { code: 'PROD001', name: 'Smartphone Premium X1', quantity: 10, unitPrice: 150.00, currentInternalUnitPrice: 160.00, newSupplierUnitPrice: 155.00, approvalStatus: 'Pendente' }
                ],
                newSupplierPriceTotal: (10 * 155).toFixed(2), currentInternalPriceTotal: (10 * 160).toFixed(2), overallApprovalStatus: 'Pendente',
                totalCubage: (10 * 3.5).toFixed(2)
            },
            {
                parentOrderId: 'SOL-014', id: 'PED-017', supplier: 'Fornecedor C', supplierCode: '44', date: '2025-06-30',
                products: [
                    { code: 'PROD003', name: 'Fone Bluetooth Max', quantity: 20, unitPrice: 40.00, currentInternalUnitPrice: 48.00, newSupplierUnitPrice: 42.00, approvalStatus: 'Pendente' }
                ],
                newSupplierPriceTotal: (20 * 42).toFixed(2), currentInternalPriceTotal: (20 * 48).toFixed(2), overallApprovalStatus: 'Pendente',
                totalCubage: (20 * 1.0).toFixed(2)
            },
            {
                parentOrderId: 'SOL-003', id: 'PED-005', supplier: 'Fornecedor B', supplierCode: '33', date: '2025-06-24',
                products: [
                    { code: 'PROD001', name: 'Smartphone Premium X1', quantity: 2, unitPrice: 150.00, currentInternalUnitPrice: 158.00, newSupplierUnitPrice: 152.00, approvalStatus: 'Pendente' },
                    { code: 'PROD003', name: 'Fone Bluetooth Max', quantity: 3, unitPrice: 45.00, currentInternalUnitPrice: 48.00, newSupplierUnitPrice: 46.00, approvalStatus: 'Pendente' }
                ],
                newSupplierPriceTotal: (2 * 152 + 3 * 46).toFixed(2), currentInternalPriceTotal: (2 * 158 + 3 * 48).toFixed(2), overallApprovalStatus: 'Negociado',
                totalCubage: (2 * 3.5 + 3 * 1.0).toFixed(2)
            },
            {
                parentOrderId: 'SOL-015', id: 'PED-018', supplier: 'Fornecedor A', supplierCode: '22', date: '2025-06-29',
                products: [
                    { code: 'PROD004', name: 'Smartwatch Sport Y', quantity: 5, unitPrice: 80.00, currentInternalUnitPrice: 85.00, newSupplierUnitPrice: 82.00, approvalStatus: 'Pendente' }
                ],
                newSupplierPriceTotal: (5 * 82).toFixed(2), currentInternalPriceTotal: (5 * 85).toFixed(2), overallApprovalStatus: 'Negociado',
                totalCubage: (5 * 0.002).toFixed(2)
            },
            {
                parentOrderId: 'SOL-008', id: 'PED-015', supplier: 'Fornecedor A', supplierCode: '22', date: '2025-06-29',
                products: [
                    { code: 'PROD001', name: 'Smartphone Premium X1', quantity: 5, unitPrice: 150.00, currentInternalUnitPrice: 158.00, newSupplierUnitPrice: 152.00, approvalStatus: 'Pendente' }
                ],
                newSupplierPriceTotal: (5 * 152).toFixed(2), currentInternalPriceTotal: (5 * 158).toFixed(2), overallApprovalStatus: 'Aguardando Aprova√ß√£o',
                totalCubage: (5 * 3.5).toFixed(2)
            },
            {
                parentOrderId: 'SOL-008', id: 'PED-016', supplier: 'Fornecedor B', supplierCode: '33', date: '2025-06-29',
                products: [
                    { code: 'PROD002', name: 'Tablet Pro Z', quantity: 2, unitPrice: 250.00, currentInternalUnitPrice: 260.00, newSupplierUnitPrice: 255.00, approvalStatus: 'Pendente' }
                ],
                newSupplierPriceTotal: (2 * 255).toFixed(2), currentInternalPriceTotal: (2 * 260).toFixed(2), overallApprovalStatus: 'Aguardando Aprova√ß√£o',
                totalCubage: (2 * 5.0).toFixed(2)
            },
            {
                parentOrderId: 'SOL-016', id: 'PED-019', supplier: 'Fornecedor B', supplierCode: '33', date: '2025-06-30',
                products: [
                    { code: 'PROD005', name: 'C√¢mera Digital Ultra HD', quantity: 1, unitPrice: 300.00, currentInternalUnitPrice: 320.00, newSupplierUnitPrice: 310.00, approvalStatus: 'Pendente' }
                ],
                newSupplierPriceTotal: (1 * 310).toFixed(2), currentInternalPriceTotal: (1 * 320).toFixed(2), overallApprovalStatus: 'Aguardando Aprova√ß√£o',
                totalCubage: (1 * 0.01).toFixed(2)
            },
            {
                parentOrderId: 'SOL-020', id: 'PED-021', supplier: 'Fornecedor A', supplierCode: '22', date: '2025-07-01',
                products: [
                    { code: 'PROD004', name: 'Smartwatch Sport Y', quantity: 3, unitPrice: 80.00, currentInternalUnitPrice: 85.00, newSupplierUnitPrice: 88.00, approvalStatus: 'Rejeitar' }
                ],
                newSupplierPriceTotal: (3 * 88).toFixed(2), currentInternalPriceTotal: (3 * 85).toFixed(2), overallApprovalStatus: 'Rejeitado',
                totalCubage: (3 * 0.002).toFixed(2)
            },
            {
                parentOrderId: 'SOL-005', id: 'PED-010', supplier: 'Fornecedor C', supplierCode: '44', date: '2025-06-26',
                products: [
                    { code: 'PROD005', name: 'C√¢mera Digital Ultra HD', quantity: 3, unitPrice: 320.00, currentInternalUnitPrice: 335.00, newSupplierUnitPrice: 320.00, approvalStatus: 'Aprovado' }
                ],
                newSupplierPriceTotal: (3 * 320).toFixed(2), currentInternalPriceTotal: (3 * 335).toFixed(2), overallApprovalStatus: 'Aprovado',
                totalCubage: (3 * 0.01).toFixed(2)
            },
            {
                parentOrderId: 'SOL-009', id: 'PED-002', supplier: 'Fornecedor B', supplierCode: '33', date: '2025-06-21',
                products: [
                    { code: 'PROD007', name: 'Cadeira Ergon√¥mica', quantity: 2, unitPrice: 600.00, currentInternalUnitPrice: 630.00, newSupplierUnitPrice: 600.00, approvalStatus: 'Aprovado' }
                ],
                newSupplierPriceTotal: (2 * 600).toFixed(2), currentInternalPriceTotal: (2 * 630).toFixed(2), overallApprovalStatus: 'Aprovado',
                totalCubage: (2 * 18.0).toFixed(2)
            },
            {
                parentOrderId: 'SOL-017', id: 'PED-020', supplier: 'Fornecedor A', supplierCode: '22', date: '2025-06-25',
                products: [
                    { code: 'PROD006', name: 'Bateria Port√°til Mega', quantity: 15, unitPrice: 20.00, currentInternalUnitPrice: 28.00, newSupplierUnitPrice: 22.00, approvalStatus: 'Finalizado' }
                ],
                newSupplierPriceTotal: (15 * 22).toFixed(2), currentInternalPriceTotal: (15 * 28).toFixed(2), overallApprovalStatus: 'Finalizado',
                totalCubage: (15 * 0.0005).toFixed(2)
            },
        ];

        initialGeneratedPurchaseOrders.forEach(po => {
            po.products.forEach(product => {
                const productInfo = productDatabase[product.code];
                if (productInfo) {
                    product.cubageUnit = productInfo.cubageUnit;
                }
            });
        });

        let generatedPurchaseOrders = JSON.parse(JSON.stringify(initialGeneratedPurchaseOrders));

        // Dados simulados de pedidos
        const orders = [
            {
                orderId: 'PED-001', parentOrderId: 'SOL-001', clientFlag: assignClientName('Hong Kong'), originCountry: 'Hong Kong',
                totalValue: 1550.00, status: 'Pendente', requestDate: '2025-06-20', lastUpdateDate: '2025-06-20',
                supplier: 'Fornecedor A', products: [{ code: 'PROD001', description: 'Smartphone Premium X1', quantity: 10, unitPrice: 155.00, cubageUnit: 3.5 }],
                totalCubage: (10 * 3.5)
            },
            {
                orderId: 'PED-002', parentOrderId: 'SOL-009', clientFlag: assignClientName('Col√¥mbia'), originCountry: 'Col√¥mbia',
                totalValue: 1200.00, status: 'Pendente', requestDate: '2025-06-21', lastUpdateDate: '2025-06-21',
                supplier: 'Fornecedor B', products: [{ code: 'PROD007', description: 'Cadeira Ergon√¥mica', quantity: 2, unitPrice: 600.00, cubageUnit: 18.0 }],
                totalCubage: (2 * 18.0)
            },
            {
                orderId: 'PED-003', parentOrderId: 'SOL-002', clientFlag: assignClientName('Hong Kong'), originCountry: 'Hong Kong',
                totalValue: 300.00, status: 'Rejeitado', requestDate: '2025-06-18', lastUpdateDate: '2025-06-19',
                supplier: 'Fornecedor A', products: [{ code: 'PROD003', description: 'Fone Bluetooth Max', quantity: 5, unitPrice: 45.00, cubageUnit: 1.0 }, { code: 'PROD006', description: 'Bateria Port√°til Mega', quantity: 5, unitPrice: 25.00, cubageUnit: 0.0005 }],
                totalCubage: (5 * 1.0 + 5 * 0.0005)
            },
            {
                orderId: 'PED-004', parentOrderId: 'SOL-010', clientFlag: assignClientName('Col√¥mbia'), originCountry: 'Col√¥mbia',
                totalValue: 800.00, status: 'Entregue', requestDate: '2025-06-23', lastUpdateDate: '2025-06-23',
                supplier: 'Fornecedor C', products: [{ code: 'PROD008', description: 'Impressora 3D Industrial', quantity: 1, unitPrice: 800.00, cubageUnit: 30.0 }],
                totalCubage: (1 * 30.0)
            },
            {
                orderId: 'PED-005', parentOrderId: 'SOL-003', clientFlag: assignClientName('Hong Kong'), originCountry: 'Hong Kong',
                totalValue: 454.00, status: 'Pendente', requestDate: '2025-06-24', lastUpdateDate: '2025-06-24',
                supplier: 'Fornecedor B', products: [{ code: 'PROD001', description: 'Smartphone Premium X1', quantity: 2, unitPrice: 152.00, cubageUnit: 3.5 }, { code: 'PROD003', description: 'Fone Bluetooth Max', quantity: 3, unitPrice: 46.00, cubageUnit: 1.0 }],
                totalCubage: (2 * 3.5 + 3 * 1.0)
            },
            {
                orderId: 'PED-006', parentOrderId: 'SOL-003', clientFlag: assignClientName('Hong Kong'), originCountry: 'Hong Kong',
                totalValue: 120.00, status: 'Chegada no Porto de Destino (ATA)', requestDate: '2025-06-24', lastUpdateDate: '2025-06-25',
                supplier: 'Fornecedor A', products: [{ code: 'PROD004', description: 'Smartwatch Sport Y', quantity: 1, unitPrice: 80.00, cubageUnit: 0.002 }, { code: 'PROD006', description: 'Bateria Port√°til Mega', quantity: 2, unitPrice: 20.00, cubageUnit: 0.0005 }],
                totalCubage: (1 * 0.002 + 2 * 0.0005)
            },
            {
                orderId: 'PED-007', parentOrderId: 'SOL-004', clientFlag: assignClientName('Col√¥mbia'), originCountry: 'Col√¥mbia',
                totalValue: 1800.00, status: 'Em Confer√™ncia', requestDate: '2025-06-25', lastUpdateDate: '2025-06-25',
                supplier: 'Fornecedor C', products: [{ code: 'PROD007', description: 'Cadeira Ergon√¥mica', quantity: 3, unitPrice: 600.00, cubageUnit: 18.0 }],
                totalCubage: (3 * 18.0)
            },
            {
                orderId: 'PED-008', parentOrderId: 'SOL-011', clientFlag: assignClientName('Hong Kong'), originCountry: 'Hong Kong',
                totalValue: 700.00, status: 'Carga Pronta', requestDate: '2025-06-25', lastUpdateDate: '2025-06-25',
                supplier: 'Fornecedor B', products: [{ code: 'PROD009', description: 'Monitor Ultrawide', quantity: 2, unitPrice: 350.00, cubageUnit: 0.05 }],
                totalCubage: (2 * 0.05)
            },
            {
                orderId: 'PED-009', parentOrderId: 'SOL-005', clientFlag: assignClientName('Hong Kong'), originCountry: 'Hong Kong',
                totalValue: 120.00, status: 'Aprovado', requestDate: '2025-06-26', lastUpdateDate: '2025-06-26',
                supplier: 'Fornecedor A', products: [{ code: 'PROD010', description: 'Teclado Mec√¢nico', quantity: 1, unitPrice: 80.00, cubageUnit: 0.01 }, { code: 'PROD011', description: 'Mouse Gamer', quantity: 1, unitPrice: 40.00, cubageUnit: 0.001 }],
                totalCubage: (1 * 0.01 + 1 * 0.001)
            },
            {
                orderId: 'PED-010', parentOrderId: 'SOL-005', clientFlag: assignClientName('Hong Kong'), originCountry: 'Hong Kong',
                totalValue: 960.00, status: 'Pendente', requestDate: '2025-06-26', lastUpdateDate: '2025-06-26',
                supplier: 'Fornecedor C', products: [{ code: 'PROD005', description: 'C√¢mera Digital Ultra HD', quantity: 3, unitPrice: 320.00, cubageUnit: 0.01 }],
                totalCubage: (3 * 0.01)
            },
            {
                orderId: 'PED-011', parentOrderId: 'SOL-006', clientFlag: assignClientName('Hong Kong'), originCountry: 'Hong Kong',
                totalValue: 100.00, status: 'Cancelado', requestDate: '2025-06-27', lastUpdateDate: '2025-06-27',
                supplier: 'Fornecedor A', products: [{ code: 'PROD003', description: 'Fone Bluetooth Max', quantity: 2, unitPrice: 50.00, cubageUnit: 1.0 }],
                totalCubage: (2 * 1.0)
            },
            {
                orderId: 'PED-012', parentOrderId: 'SOL-012', clientFlag: assignClientName('Col√¥mbia'), originCountry: 'Col√¥mbia',
                totalValue: 800.00, status: 'Em Rota de Entrega', requestDate: '2025-06-27', lastUpdateDate: '2025-06-27',
                supplier: 'Fornecedor B', products: [{ code: 'PROD008', description: 'Impressora 3D Industrial', quantity: 1, unitPrice: 800.00, cubageUnit: 30.0 }],
                totalCubage: (1 * 30.0)
            },
            {
                orderId: 'PED-013', parentOrderId: 'SOL-007', clientFlag: assignClientName('Col√¥mbia'), originCountry: 'Col√¥mbia',
                totalValue: 1200.00, status: 'Pendente', requestDate: '2025-06-28', lastUpdateDate: '2025-06-28',
                supplier: 'Fornecedor C', products: [{ code: 'PROD007', description: 'Cadeira Ergon√¥mica', quantity: 2, unitPrice: 600.00, cubageUnit: 18.0 }],
                totalCubage: (2 * 18.0)
            },
            {
                orderId: 'PED-014', parentOrderId: 'SOL-013', clientFlag: assignClientName('Hong Kong'), originCountry: 'Hong Kong',
                totalValue: 160.00, status: 'Sa√≠da do Porto de Embarque (ATD)', requestDate: '2025-06-28', lastUpdateDate: '2025-06-28',
                supplier: 'Fornecedor A', products: [{ code: 'PROD001', description: 'Smartphone Premium X1', quantity: 1, unitPrice: 160.00, cubageUnit: 3.5 }],
                totalCubage: (1 * 3.5)
            },
            {
                orderId: 'PED-015', parentOrderId: 'SOL-008', clientFlag: assignClientName('Hong Kong'), originCountry: 'Hong Kong',
                totalValue: 760.00, status: 'Pendente', requestDate: '2025-06-29', lastUpdateDate: '2025-06-29',
                supplier: 'Fornecedor A', products: [{ code: 'PROD001', description: 'Smartphone Premium X1', quantity: 5, unitPrice: 152.00, cubageUnit: 3.5 }],
                totalCubage: (5 * 3.5)
            },
            {
                orderId: 'PED-016', parentOrderId: 'SOL-008', clientFlag: assignClientName('Hong Kong'), originCountry: 'Hong Kong',
                totalValue: 510.00, status: 'Pendente', requestDate: '2025-06-29', lastUpdateDate: '2025-06-29',
                supplier: 'Fornecedor B', products: [{ code: 'PROD002', description: 'Tablet Pro Z', quantity: 2, unitPrice: 255.00, cubageUnit: 5.0 }],
                totalCubage: (2 * 5.0)
            },
            {
                orderId: 'PED-017', parentOrderId: 'SOL-014', clientFlag: assignClientName('Hong Kong'), originCountry: 'Hong Kong',
                totalValue: 840.00, status: 'Pendente', requestDate: '2025-06-30', lastUpdateDate: '2025-06-30',
                supplier: 'Fornecedor C', products: [{ code: 'PROD003', description: 'Fone Bluetooth Max', quantity: 20, unitPrice: 42.00, cubageUnit: 1.0 }],
                totalCubage: (20 * 1.0)
            },
            {
                orderId: 'PED-018', parentOrderId: 'SOL-015', clientFlag: assignClientName('Hong Kong'), originCountry: 'Hong Kong',
                totalValue: 410.00, status: 'Pendente', requestDate: '2025-06-29', lastUpdateDate: '2025-06-29',
                supplier: 'Fornecedor A', products: [{ code: 'PROD004', description: 'Smartwatch Sport Y', quantity: 5, unitPrice: 82.00, cubageUnit: 0.002 }],
                totalCubage: (5 * 0.002)
            },
            {
                orderId: 'PED-019', parentOrderId: 'SOL-016', clientFlag: assignClientName('Hong Kong'), originCountry: 'Hong Kong',
                totalValue: 310.00, status: 'Pendente', requestDate: '2025-06-30', lastUpdateDate: '2025-06-30',
                supplier: 'Fornecedor B', products: [{ code: 'PROD005', description: 'C√¢mera Digital Ultra HD', quantity: 1, unitPrice: 310.00, cubageUnit: 0.01 }],
                totalCubage: (1 * 0.01)
            },
            {
                orderId: 'PED-020', parentOrderId: 'SOL-017', clientFlag: assignClientName('Hong Kong'), originCountry: 'Hong Kong',
                totalValue: 330.00, status: 'Pendente', requestDate: '2025-06-25', lastUpdateDate: '2025-06-25',
                supplier: 'Fornecedor A', products: [{ code: 'PROD006', description: 'Bateria Port√°til Mega', quantity: 15, unitPrice: 22.00, cubageUnit: 0.0005 }],
                totalCubage: (15 * 0.0005)
            },
            {
                orderId: 'SAP-001', parentOrderId: 'SOL-018', clientFlag: assignClientName('Col√¥mbia'), originCountry: 'Col√¥mbia',
                totalValue: 500.00, status: 'Em Separa√ß√£o', requestDate: '2025-07-01', lastUpdateDate: '2025-07-01',
                supplier: 'Fornecedor C', products: [{ code: 'PROD009', description: 'Monitor Ultrawide', quantity: 1, unitPrice: 350.00, cubageUnit: 0.05 }, { code: 'PROD003', description: 'Fone Bluetooth Max', quantity: 3, unitPrice: 50.00, cubageUnit: 1.0 }],
                totalCubage: (1 * 0.05 + 3 * 1.0)
            }
        ];

        // Contadores para IDs de pedidos
        let nextParentRequestCounter = orders.reduce((max, order) => {
            const solNum = order.parentOrderId && typeof order.parentOrderId === 'string'
                            ? parseInt(order.parentOrderId.replace('SOL-', '')) : 0;
            return isNaN(solNum) ? max : Math.max(max, solNum);
        }, 0) + 1;

        let nextPurchaseOrderIdCounter = orders.reduce((max, order) => {
            const pedNum = order.orderId && typeof order.orderId === 'string' && order.orderId.startsWith('PED-')
                            ? parseInt(order.orderId.replace('PED-', '')) : 0;
            return isNaN(pedNum) ? max : Math.max(max, pedNum);
        }, 0) + 1;

        let nextSapOrderIdCounter = orders.reduce((max, order) => {
            const sapNum = order.orderId && typeof order.orderId === 'string' && order.orderId.startsWith('SAP-')
                            ? parseInt(order.orderId.replace('SAP-', '')) : 0;
            return isNaN(sapNum) ? max : Math.max(max, sapNum);
        }, 0) + 1;

        // Objeto de tradu√ß√µes para m√∫ltiplos idiomas
        const translations = {
            'pt-BR': {
                centralOrdersTitle: 'Central de Pedidos',
                newRequestButton: 'Nova Solicita√ß√£o',
                logoutButton: 'Sair (Logout)',
                statusFilterLabel: 'Status:',
                allOption: 'Todos',
                statusPending: 'Pendente',
                statusApproved: 'Aprovado',
                statusRejected: 'Rejeitado',
                statusInConference: 'Em Confer√™ncia',
                statusDelivered: 'Entregue',
                statusCargoReady: 'Carga Pronta',
                statusInDeliveryRoute: 'Em Rota de Entrega',
                statusATD: 'Sa√≠da do Porto de Embarque (ATD)',
                statusATA: 'Chegada no Porto de Destino (ATA)',
                statusCancelled: 'Cancelado',
                statusNegotiation: 'Em Negocia√ß√£o',
                statusWaitingApproval: 'Aguardando Aprova√ß√£o',
                statusProduction: 'Em Produ√ß√£o',
                statusPendingDoc: 'Documenta√ß√£o Pendente',
                statusDocOk: 'Documenta√ß√£o OK',
                statusFinished: 'Finalizado',
                statusSeparation: 'Em Separa√ß√£o',
                statusInTransit: 'Em Rota de Entrega',
                supplierFilterLabel: 'Fornecedor:',
                originCountryFilterLabel: 'Pa√≠s Origem:',
                searchLabel: 'Buscar por N¬∫ Pedido ou Cliente:',
                searchPlaceholder: 'Buscar por N¬∫ Pedido ou Cliente',
                colMainRequestId: 'ID SOLICITA√á√ÉO PRINCIPAL',
                colOrderNumber: 'N¬∫ PEDIDO',
                colOrigin: 'ORIGEM',
                colOriginCountry: 'PA√çS ORIGEM',
                colSupplier: 'FORNECEDOR',
                colTotalValue: 'VALOR TOTAL',
                colOrderStatus: 'STATUS DO PEDIDO',
                colRequestDate: 'DATA SOLICITA√á√ÉO/CRIA√á√ÉO',
                colLastChangeDate: 'DATA √öLTIMA ALTERA√á√ÉO',
                noOrdersFound: 'Nenhum pedido encontrado com os filtros aplicados.',
                orderDetailsTitle: 'Detalhes do Pedido',
                generalInfoTitle: 'Informa√ß√µes Gerais',
                orderNumberLabel: 'N¬∫ Pedido:',
                mainIdLabel: 'ID Principal:',
                originLabel: 'Origem:',
                supplierLabel: 'Fornecedor:',
                totalValueLabel: 'Valor Total:',
                freightLabel: 'FREIGHT:',
                orderStatusLabel: 'Status do Pedido:',
                requestCreationDateLabel: 'Data Solicita√ß√£o/Cria√ß√£o:',
                lastChangeDateLabel: 'Data √öltima Altera√ß√£o:',
                trackingStatusTitle: 'Status de Rastreamento',
                trackingNotAvailable: 'Rastreamento n√£o dispon√≠vel para esta origem.',
                orderProductsTitle: 'Produtos do Pedido',
                colProductCode: 'C√≥digo Produto',
                colDescription: 'Descri√ß√£o',
                colQuantity: 'Quantidade',
                colUnitPrice: 'Valor Unit√°rio',
                colTotalItemValue: 'Valor Total Item',
                backToOrderCenterButton: 'Voltar para Central de Pedidos',
                CenterButton2: 'Tracking',
                newPurchaseRequestTitle: 'Nova Solicita√ß√£o de Compra',
                newPurchaseRequestSubtitle: 'Por favor, preencha os detalhes dos produtos desejados.',
                clientOrderNumberLabel: 'N√∫mero do Pedido do Cliente (Opcional)',
                clientOrderNumberPlaceholder: 'Seu n√∫mero de refer√™ncia do pedido',
                easyOrderTab: 'Pedido F√°cil',
                manualOrderTab: 'Pedido Manual',
                easyOrderTitle: 'Pedido F√°cil',
                easyOrderSubtitle: 'Escolha uma das op√ß√µes abaixo para adicionar os produtos ao carrinho de compras',
                uploadSpreadsheetHeader: 'Upload de Planilha',
                noFileSelected: 'Nenhum arquivo selecionado',
                uploadButton: 'Fazer Upload',
                uploadLimitInfo: 'Limite de 50 linhas de produtos e 5MB de tamanho.',
                pasteCodesHeader: 'Copiar e Colar C√≥digos',
                pasteCodesPlaceholder: 'Cole aqui os c√≥digos e quantidades (Ex: COD1,10;COD2,5 ou COD1,10 ENTER COD2,5)',
                processCodesButton: 'Processar C√≥digos Colados',
                howToUseSpreadsheetTitle: 'Saiba como utilizar nosso modelo de planilha',
                step1Title: 'Passo 1',
                step1Description: 'Fa√ßa o download do modelo de planilha. Abra a planilha no seu computador e preencha com o c√≥digo do produto do cliente e a quantidade desejada. M√°ximo de 50 linhas de produtos por pedido.',
                spreadsheetModelLink: 'Modelo de Planilha',
                step2Title: 'Passo 2',
                step2Description: 'Com sua planilha pronta e salva no seu computador, clique em Selecionar arquivo. Em seguida, clique em Fazer upload. O tamanho da planilha n√£o deve ultrapassar 5MB de tamanho.',
                step3Title: 'Passo 3',
                step3Description: 'Com sua planilha pronta e salva no seu computador, clique em Selecionar arquivo. Em seguida, clique em Fazer upload. O tamanho da planilha n√£o deve ultrapassar 5MB de tamanho.',
                addProductsTitle: 'Adicionar Produtos',
                clientProductCodeLabel: 'C√≥d Prod Cliente:',
                clientProductCodePlaceholder: 'C√≥d Cliente',
                productCodeLabel: 'C√≥d Produto:',
                descriptionLabel: 'Descri√ß√£o:',
                quantityLabel: 'Quantidade:',
                unitValueLabel: 'Valor Unit.:',
                totalM3Label: 'M¬≥ Total:',
                stockLabel: 'Estoque:',
                addProductButton: 'Adicionar Produto',
                invalidClientProductCode: 'Erro: C√≥digo de produto cliente inv√°lido.',
                invalidQuantity: 'Erro: Por favor, insira uma quantidade v√°lida para o produto.',
                quantityUpdated: (desc, qty) => `Quantidade de "${desc}" atualizada para ${qty}.`,
                productAdded: (desc) => `"${desc}" adicionado com sucesso.`,
                productRemoved: 'Produto removido.',
                invalidProductIndex: 'Erro: N√£o foi poss√≠vel remover o produto. √çndice inv√°lido.',
                invalidQuantityInput: 'Quantidade inv√°lida. Por favor, insira um n√∫mero maior que zero.',
                qtyBelowMOQWarning: (qty, moq) => `‚ö†Ô∏è Quantidade (${qty}) abaixo do MOQ m√≠nimo (${moq}) para Hong Kong.`,
                qtyMeetsMOQSuccess: (qty, moq) => `‚úÖ Quantidade (${qty}) atende ao MOQ m√≠nimo (${moq}) para Hong Kong.`,
                qtyExceedsStockError: (qty, stock) => `üö´ Quantidade (${qty}) excede o estoque dispon√≠vel (${stock}) na Col√¥mbia.`,
                qtyAvailableStockSuccess: (qty) => `‚úÖ Quantidade (${qty}) dispon√≠vel em estoque na Col√¥mbia.`,
                noProductsAdded: 'Nenhum produto adicionado ainda.',
                columbiaStock: 'Estoque',
                hongKongMOQContainer: 'MOQ Container',
                selectedBranch: 'Filial Selecionada',
                action: 'A√ß√£o',
                remove: 'Remover',
                branchDifferencesTitle: 'Diferen√ßas de Compra por Filial:',
                colombiaBranchTitle: 'Col√¥mbia',
                colombiaDeliveryTime: 'Previs√£o de Entrega: ~45 dias',
                priceModelTitle: 'Modelo de Pre√ßo:',
                colombiaPriceModelDesc: 'Pre√ßo √∫nico para produtos dispon√≠veis em estoque.',
                colombiaStockInfo: 'Foco em produtos com estoque dispon√≠vel.',
                hongKongBranchTitle: 'Hong Kong',
                hongKongDeliveryTime: 'Previs√£o de Entrega: ~90 dias',
                hongKongPriceModelLCL: '<strong>LCL:</strong> Mais caro (para volumes pequenos)',
                hongKongPriceModel20ft: '<strong>Container 20ft:</strong> Pre√ßo intermedi√°rio',
                hongKongPriceModel40ft: '<strong>Container 40ft:</strong> Mais barato (para volumes maiores)',
                hongKongMOQInfo: 'Para adquirir, √© necess√°rio atender ao MOQ (Quantidade M√≠nima de Pedido).',
                backButton: 'Voltar',
                submitRequestButton: 'Enviar Solicita√ß√£o',
                addAtLeastOneProduct: 'Por favor, adicione pelo menos um produto antes de enviar a solicita√ß√£o.',
                validationErrorsTitle: 'Erros de Valida√ß√£o',
                requestSummaryTitle: 'Resumo da Solicita√ß√£o',
                requestSummarySubtitle: 'Confira a divis√£o dos produtos por filial e fornecedor.',
                backAndAdjustButton: 'Voltar e Ajustar',
                confirmAndGenerateButton: 'Confirmar e Gerar Pedidos',
                hongKongOrdersTitle: 'Pedidos para Hong Kong',
                moqAttention: 'Aten√ß√£o: Problemas de MOQ detectados!',
                moqError: 'Erro: Itens cancelados devido a falha no MOQ!',
                supplierDivisionTitle: 'Divis√£o por Fornecedor (Requisi√ß√µes de Compra - POs):',
                poNumberForSupplier: (poId, supplierCode, supplierName) => `PO N¬∫ ${poId} para Fornecedor: <strong>${supplierCode} - ${supplierName}</strong>`,
                mainRequestId: 'ID Solicita√ß√£o Principal:',
                generationDate: 'Data Gera√ß√£o:',
                estimatedOrderTotal: 'Valor Total Pedido (Estimado):',
                containerForecast: 'Previs√£o de Container:',
                products: 'Produtos:',
                colModel: 'Modelo',
                colProductCode: 'C√≥digo',
                colDescription: 'Descri√ß√£o',
                colQuantity: 'Qtd.',
                colUnitPrice: 'Pre√ßo Unit.',
                colTotalPrice: 'Pre√ßo Total',
                colM3Unit: 'M¬≥ Unit.',
                colM3Total: 'M¬≥ Total',
                colContainerPercentage: '% Container',
                cubageForecastTitle: 'Previs√£o de Cubagem por Tipo de Container (Total do Pedido):',
                totalOrderCubage: (cubage) => `Cubagem Total do Pedido: <strong>${cubage} m¬≥</strong>`,
                containerType: 'Tipo CTN',
                occupationPercentage: '% Ocupa√ß√£o',
                totalM3CTN: 'M¬≥ Total CTN',
                priceDisclaimer: 'Os pre√ßos apresentados s√£o estimativas e podem sofrer altera√ß√µes. Custos adicionais de frete, impostos ou outras taxas podem ser aplicados.',
                colombiaOrderTitle: 'Pedido para Col√¥mbia',
                salesOrderDetailsTitle: 'Detalhes do Pedido de Venda',
                salesOrderNumberSAP: 'N¬∫ Pedido de Venda SAP:',
                totalValue: 'Valor Total:',
                noSummaryOrders: 'Nenhum pedido para exibir no resumo.',
                requestSentTitle: 'Solicita√ß√£o Enviada',
                requestSentMessage: 'Sua solicita√ß√£o foi processada e os pedidos foram gerados. Voc√™ pode acompanhar o status na Central de Pedidos.',
                poDetailsTitle: 'Detalhes da Ordem de Compra (PO)',
                viewNFeTitle: 'Visualizar NF-e',
                nfeContentNotAvailable: 'Conte√∫do da NF-e n√£o dispon√≠vel.',
                viewPOPdfTitle: 'Visualizar PDF da PO',
                okButton: 'OK',
                cancelButton: 'Cancelar',
                productCatalogTitle: 'Cat√°logo de Produtos',
                searchCatalogPlaceholder: 'Buscar por c√≥digo ou descri√ß√£o...',
                searchButton: 'Buscar',
                closeButton: 'Fechar',
                catalogClientProductCode: 'C√≥d Prod Cliente',
                catalogProductCode: 'C√≥d Produto',
                catalogDescription: 'Descri√ß√£o',
                catalogDefaultBranch: 'Filial Padr√£o',
                catalogUnitPrice: 'Pre√ßo Unit.',
                catalogMOQ: 'MOQ',
                catalogStock: 'Estoque',
                catalogM3Unit: 'M¬≥ Unit.',
                catalogLine: 'Linha',
                uploadSuccess: (filename, added, skipped) => `Upload de "${filename}" conclu√≠do! ${added} produto(s) adicionado(s).${skipped > 0 ? ` ${skipped} item(ns) ignorado(s).` : ''}`,
                uploadFileSelect: 'Por favor, selecione um arquivo para upload.',
                invalidFileType: 'Tipo de arquivo inv√°lido. Por favor, selecione um arquivo Excel (.xlsx, .xls) ou CSV.',
                fileSizeExceeded: 'O arquivo excede o tamanho m√°ximo permitido de 5MB.',
                spreadsheetModelDownloaded: 'Modelo de planilha baixado com sucesso!',
                pasteCodesEmpty: 'Por favor, cole os c√≥digos e quantidades na caixa de texto.',
                codesProcessedSuccess: (added, skipped) => `${added} produto(s) processado(s) com sucesso.${skipped > 0 ? ` ${skipped} item(ns) ignorado(s).` : ''}`,
                invalidFormatOrProduct: (item) => `Formato inv√°lido ou produto/quantidade n√£o encontrado para: "${item}".`,
                expectedFormat: (item) => `Formato inv√°lido para: "${item}". Esperado "CODIGO,QUANTIDADE".`,
                infoScreenInfoTitle: 'Informa√ß√µes da Tela',
                infoCentralOrdersTitle: 'üìÇ Central de Pedidos',
                infoCentralOrdersDesc: 'Bem-vindo √† <b>Central de Pedidos</b>! Aqui voc√™ pode gerenciar e acompanhar todas as solicita√ß√µes do in√≠cio ao fim.',
                infoSearchFiltersTitle: 'üîç Busca e Filtros',
                infoSearchFiltersList: '<li>Filtre pedidos por <b>Status</b>, <b>Fornecedor</b> (c√≥digo), <b>Pa√≠s de Origem</b> (Col√¥mbia ou Hong Kong) ou <b>Cliente</b>.</li><li>Utilize a busca r√°pida por n√∫mero do pedido, ID principal ou nome do cliente.</li>',
                infoOrdersViewTitle: 'üìã Visualiza√ß√£o dos Pedidos',
                infoOrdersViewList: '<li>Veja todos os pedidos em uma tabela detalhada.</li><li>Clique no n√∫mero do pedido para acessar os detalhes completos.</li>',
                infoNewRequestTitle: 'üÜï Nova Solicita√ß√£o',
                infoNewRequestList: '<li>Clique em <b>Nova Solicita√ß√£o</b> para iniciar um novo pedido, escolhendo a filial de destino (<b>Hong Kong</b> ou <b>Col√¥mbia</b>).</li>',
                infoVisualTipsTitle: 'üü¢ Dicas Visuais',
                infoVisualTipsList: '<li><b>Cores dos status:</b><span style="color:#16a34a;">üü¢ Aprovado</span> | <span style="color:#eab308;">üü° Pendente</span> | <span style="color:#dc2626;">üî¥ Rejeitado</span> | <span style="color:#3b82f6;">üîµ Em andamento</span> | <span style="color:#6b7280;">‚ö™ Cancelado</span></li><li><b>√çcones de bandeira:</b> Indicam o pa√≠s de origem do pedido.</li>',
                infoGeneralHelp: 'Se precisar de ajuda, clique novamente neste √≠cone ou consulte o manual do usu√°rio.',
                infoOrderDetailsTitle: 'üìÑ Detalhes do Pedido',
                infoOrderDetailsDesc: 'Veja todas as informa√ß√µes detalhadas do pedido selecionado:',
                infoOrderDetailsList: '<li><b>Dados Gerais:</b> N√∫mero do pedido, ID principal, origem, fornecedor, valores e datas.</li><li><b>Status do Pedido:</b> Acompanhe o andamento por meio do rastreamento visual com etapas e cores.</li><li><b>Produtos:</b> Lista completa de itens, quantidades e valores.</li><li><b>A√ß√µes:</b> Utilize o bot√£o para voltar √† Central de Pedidos.</li>',
                infoOrderDetailsTip: '<b>Dica:</b> O rastreamento mostra cada etapa do fluxo log√≠stico do pedido.',
                infoNewRequestFormTitle: 'üìù Nova Solicita√ß√£o de Compra',
                infoNewRequestFormDesc: 'Crie uma nova solicita√ß√£o de compra. Adicione produtos e selecione a filial de origem para cada uno.',
                infoNewRequestFormList: '<li><b>Pedido F√°cil:</b> Adicione produtos rapidamente via upload de planilha ou colando c√≥digos (para grandes volumes).</li><li><b>Pedido Manual:</b> Insira produtos individualmente, consultando o cat√°logo se necess√°rio. A <b>Filial</b> (Hong Kong ou Col√¥mbia) ser√° selecionada na tabela de produtos adicionados.</li><li><b>Valida√ß√£o:</b> O sistema valida automaticamente a quantidade m√≠nima de compra (MOQ) para Hong Kong e o estoque dispon√≠vel para Col√¥mbia, com base na filial do produto.</li>',
                infoNewRequestFormTip: '<b>Dica:</b> A valida√ß√£o de estoque e MOQ √© feita por produto, de acordo com a filial do produto!',
                infoSummaryScreenTitle: 'üìä Resumo da Solicita√ß√£o',
                infoSummaryScreenDesc: 'Revise a divis√£o dos produtos por filial e fornecedor antes de confirmar.',
                infoSummaryScreenList: '<li><b>Pedidos Hong Kong:</b> Agrupados por fornecedor, com valida√ß√£o de MOQ e compara√ß√£o de custos.</li><li><b>Pedidos Col√¥mbia:</b> Um √∫nico pedido para todos os itens, com detalhes da NF-e simulada.</li><li><b>A√ß√µes:</b> Volte para ajustar os produtos ou confirme para gerar os pedidos de compra.</li>',
                infoSummaryScreenTip: '<b>Dica:</b> Verifique cuidadosamente as informa√ß√µes de MOQ e estoque antes de confirmar.',
                infoPurchaseOrderScreenTitle: '‚úÖ Solicita√ß√£o Gerada',
                infoPurchaseOrderScreenDesc: 'Sua solicita√ß√£o foi gerada e enviada para Compras Internacionais.',
                infoPurchaseOrderScreenList: '<li>Veja os detalhes da PO (Purchase Order).</li><li>Aguarde a negocia√ß√£o e aprova√ß√£o do gestor.</li><li>Utilize o bot√£o para voltar √† Central de Pedidos.</li>',
                infoPurchaseOrderScreenTip: '<b>Dica:</b> Acompanhe o status do pedido na Central de Pedidos.',
                productsAddedToRequestTitle: 'Produtos Adicionados na Solicita√ß√£o:',
                yes: 'Sim',
                no: 'N√£o',
            },
            'en': {
                centralOrdersTitle: 'Order Center',
                newRequestButton: 'New Request',
                logoutButton: 'Logout',
                statusFilterLabel: 'Status:',
                allOption: 'All',
                statusPending: 'Pending',
                statusApproved: 'Approved',
                statusRejected: 'Rejected',
                statusInConference: 'In Conference',
                statusDelivered: 'Delivered',
                statusCargoReady: 'Cargo Ready',
                statusInDeliveryRoute: 'In Delivery Route',
                statusATD: 'Departure from Port of Loading (ATD)',
                statusATA: 'Arrival at Port of Destination (ATA)',
                statusCancelled: 'Cancelled',
                statusNegotiation: 'In Negotiation',
                statusWaitingApproval: 'Awaiting Approval',
                statusProduction: 'In Production',
                statusPendingDoc: 'Pending Documentation',
                statusDocOk: 'Documentation OK',
                statusFinished: 'Finished',
                statusSeparation: 'In Separation',
                statusInTransit: 'In Delivery Route',
                supplierFilterLabel: 'Supplier:',
                originCountryFilterLabel: 'Origin Country:',
                searchLabel: 'Search by Order No. or Client:',
                searchPlaceholder: 'Search by Order No. or Client',
                colMainRequestId: 'MAIN REQUEST ID',
                colOrderNumber: 'ORDER NO.',
                colOrigin: 'ORIGIN',
                colOriginCountry: 'ORIGIN COUNTRY',
                colSupplier: 'SUPPLIER',
                colTotalValue: 'TOTAL VALUE',
                colOrderStatus: 'ORDER STATUS',
                colRequestDate: 'REQUEST/CREATION DATE',
                colLastChangeDate: 'LAST CHANGE DATE',
                noOrdersFound: 'No orders found with the applied filters.',
                orderDetailsTitle: 'Order Details',
                generalInfoTitle: 'General Information',
                orderNumberLabel: 'Order No.:',
                mainIdLabel: 'Main ID:',
                originLabel: 'Origin:',
                supplierLabel: 'Supplier:',
                totalValueLabel: 'Total Value:',
                freightLabel: 'FREIGHT:',
                orderStatusLabel: 'Order Status:',
                requestCreationDateLabel: 'Request/Creation Date:',
                lastChangeDateLabel: 'Last Change Date:',
                trackingStatusTitle: 'Tracking Status',
                trackingNotAvailable: 'Tracking not available for this origin.',
                orderProductsTitle: 'Order Products',
                colProductCode: 'Product Code',
                colDescription: 'Description',
                colQuantity: 'Quantity',
                colUnitPrice: 'Unit Value',
                colTotalItemValue: 'Total Item Value',
                backToOrderCenterButton: 'Back to Order Center',
                CenterButton2: 'Tracking',
                newPurchaseRequestTitle: 'New Purchase Request',
                newPurchaseRequestSubtitle: 'Please fill in the details of the desired products.',
                clientOrderNumberLabel: 'Client Order Number (Optional)',
                clientOrderNumberPlaceholder: 'Your order reference number',
                easyOrderTab: 'Easy Order',
                manualOrderTab: 'Manual Order',
                easyOrderTitle: 'Easy Order',
                easyOrderSubtitle: 'Choose one of the options below to add products to the shopping cart',
                uploadSpreadsheetHeader: 'Upload Spreadsheet',
                noFileSelected: 'No file selected',
                uploadButton: 'Upload',
                uploadLimitInfo: 'Limit of 50 product lines and 5MB size.',
                pasteCodesHeader: 'Copy and Paste Codes',
                pasteCodesPlaceholder: 'Paste codes and quantities here (Ex: CODE1,10;CODE2,5 or CODE1,10 ENTER CODE2,5)',
                processCodesButton: 'Process Pasted Codes',
                howToUseSpreadsheetTitle: 'Learn how to use our spreadsheet template',
                step1Title: 'Step 1',
                step1Description: 'Download the spreadsheet template. Open the spreadsheet on your computer and fill in the client product code and desired quantity. Maximum of 50 product lines per order.',
                spreadsheetModelLink: 'Spreadsheet Template',
                step2Title: 'Step 2',
                step2Description: 'With your spreadsheet ready and saved on your computer, click Select file. Then, click Upload. The spreadsheet size must not exceed 5MB.',
                step3Title: 'Step 3',
                step3Description: 'With your spreadsheet ready and saved on your computer, click Select file. Then, click Upload. The spreadsheet size must not exceed 5MB.',
                addProductsTitle: 'Add Products',
                clientProductCodeLabel: 'Client Prod Code:',
                clientProductCodePlaceholder: 'Client Code',
                productCodeLabel: 'Product Code:',
                descriptionLabel: 'Description:',
                quantityLabel: 'Quantity:',
                unitValueLabel: 'Unit Value:',
                totalM3Label: 'Total M¬≥:',
                stockLabel: 'Stock:',
                addProductButton: 'Add Product',
                invalidClientProductCode: 'Error: Invalid client product code.',
                invalidQuantity: 'Error: Please enter a valid quantity for the product.',
                quantityUpdated: (desc, qty) => `Quantity of "${desc}" updated to ${qty}.`,
                productAdded: (desc) => `"${desc}" added successfully.`,
                productRemoved: 'Product removed.',
                invalidProductIndex: 'Error: Could not remove product. Invalid index.',
                invalidQuantityInput: 'Invalid quantity. Please enter a number greater than zero.',
                qtyBelowMOQWarning: (qty, moq) => `‚ö†Ô∏è Quantity (${qty}) below minimum MOQ (${moq}) for Hong Kong.`,
                qtyMeetsMOQSuccess: (qty, moq) => `‚úÖ Quantity (${qty}) meets minimum MOQ (${moq}) for Hong Kong.`,
                qtyExceedsStockError: (qty, stock) => `üö´ Quantity (${qty}) exceeds available stock (${stock}) in Colombia.`,
                qtyAvailableStockSuccess: (qty) => `‚úÖ Quantity (${qty}) available in stock in Colombia.`,
                noProductsAdded: 'No products added yet.',
                columbiaStock: 'Stock',
                hongKongMOQContainer: 'MOQ Container',
                selectedBranch: 'Selected Branch',
                action: 'Action',
                remove: 'Remove',
                branchDifferencesTitle: 'Purchase Differences by Branch:',
                colombiaBranchTitle: 'Colombia',
                colombiaDeliveryTime: 'Delivery Forecast: ~45 days',
                priceModelTitle: 'Price Model:',
                colombiaPriceModelDesc: 'Single price for products available in stock.',
                colombiaStockInfo: 'Focus on products with available stock.',
                hongKongBranchTitle: 'Hong Kong',
                hongKongDeliveryTime: 'Delivery Forecast: ~90 days',
                hongKongPriceModelLCL: '<strong>LCL:</strong> More expensive (for small volumes)',
                hongKongPriceModel20ft: '<strong>20ft Container:</strong> Intermediate price',
                hongKongPriceModel40ft: '<strong>40ft Container:</strong> Cheaper (for larger volumes)',
                hongKongMOQInfo: 'To purchase, MOQ (Minimum Order Quantity) must be met.',
                backButton: 'Back',
                submitRequestButton: 'Submit Request',
                addAtLeastOneProduct: 'Please add at least one product before submitting the request.',
                validationErrorsTitle: 'Validation Errors',
                requestSummaryTitle: 'Request Summary',
                requestSummarySubtitle: 'Check the division of products by branch and supplier.',
                backAndAdjustButton: 'Back and Adjust',
                confirmAndGenerateButton: 'Confirm and Generate Orders',
                hongKongOrdersTitle: 'Orders for Hong Kong',
                moqAttention: 'Attention: MOQ issues detected!',
                moqError: 'Error: Items cancelled due to MOQ failure!',
                supplierDivisionTitle: 'Division by Supplier (Purchase Requisitions - POs):',
                poNumberForSupplier: (poId, supplierCode, supplierName) => `PO No. ${poId} for Supplier: <strong>${supplierCode} - ${supplierName}</strong>`,
                mainRequestId: 'Main Request ID:',
                generationDate: 'Generation Date:',
                estimatedOrderTotal: 'Estimated Order Total Value:',
                containerForecast: 'Container Forecast:',
                products: 'Products:',
                colModel: 'Model',
                colProductCode: 'Code',
                colDescription: 'Description',
                colQuantity: 'Qty.',
                colUnitPrice: 'Unit Price',
                colTotalPrice: 'Total Price',
                colM3Unit: 'Unit M¬≥.',
                colM3Total: 'Total M¬≥.',
                colContainerPercentage: '% Container',
                cubageForecastTitle: 'Cubage Forecast by Container Type (Total Order):',
                totalOrderCubage: (cubage) => `Total Order Cubage: <strong>${cubage} m¬≥</strong>`,
                containerType: 'CTN Type',
                occupationPercentage: '% Occupation',
                totalM3CTN: 'Total M¬≥ CTN',
                priceDisclaimer: 'Prices are estimates and may change. Additional freight, taxes, or other fees may apply.',
                colombiaOrderTitle: 'Order for Colombia',
                salesOrderDetailsTitle: 'Sales Order Details',
                salesOrderNumberSAP: 'SAP Sales Order No.:',
                totalValue: 'Total Value:',
                noSummaryOrders: 'No orders to display in the summary.',
                requestSentTitle: 'Request Sent',
                requestSentMessage: 'Your request has been processed and orders have been generated. You can track the status in the Order Center.',
                poDetailsTitle: 'Purchase Order (PO) Details',
                viewNFeTitle: 'View NF-e',
                nfeContentNotAvailable: 'NF-e content not available.',
                viewPOPdfTitle: 'View PO PDF',
                okButton: 'OK',
                cancelButton: 'Cancel',
                productCatalogTitle: 'Product Catalog',
                searchCatalogPlaceholder: 'Search by code or description...',
                searchButton: 'Search',
                closeButton: 'Close',
                catalogClientProductCode: 'Client Prod Code',
                catalogProductCode: 'Product Code',
                catalogDescription: 'Description',
                catalogDefaultBranch: 'Default Branch',
                catalogUnitPrice: 'Unit Price',
                catalogMOQ: 'MOQ',
                catalogStock: 'Stock',
                catalogM3Unit: 'Unit M¬≥.',
                catalogLine: 'Line',
                uploadSuccess: (filename, added, skipped) => `Upload of "${filename}" complete! ${added} product(s) added.${skipped > 0 ? ` ${skipped} item(s) skipped.` : ''}`,
                uploadFileSelect: 'Please select a file to upload.',
                invalidFileType: 'Invalid file type. Please select an Excel (.xlsx, .xls) or CSV file.',
                fileSizeExceeded: 'The file exceeds the maximum allowed size of 5MB.',
                spreadsheetModelDownloaded: 'Spreadsheet template downloaded successfully!',
                pasteCodesEmpty: 'Please paste codes and quantities in the text box.',
                codesProcessedSuccess: (added, skipped) => `${added} product(s) processed successfully.${skipped > 0 ? ` ${skipped} item(s) skipped.` : ''}`,
                invalidFormatOrProduct: (item) => `Invalid format or product/quantity not found for: "${item}".`,
                expectedFormat: (item) => `Invalid format for: "${item}". Expected "CODE,QUANTITY".`,
                infoScreenInfoTitle: 'Screen Information',
                infoCentralOrdersTitle: 'üìÇ Order Center',
                infoCentralOrdersDesc: 'Welcome to the <b>Order Center</b>! Here you can manage and track all requests from start to finish.',
                infoSearchFiltersTitle: 'üîç Search and Filters',
                infoSearchFiltersList: '<li>Filter orders by <b>Status</b>, <b>Supplier</b> (code), <b>Origin Country</b> (Colombia or Hong Kong), or <b>Client</b>.</li><li>Use quick search by order number, main ID, or client name.</li>',
                infoOrdersViewTitle: 'üìã Order View',
                infoOrdersViewList: '<li>View all orders in a detailed table.</li><li>Click on the order number to access full details.</li>',
                infoNewRequestTitle: 'üÜï New Request',
                infoNewRequestList: '<li>Click on <b>New Request</b> to start a new order, choosing the destination branch (<b>Hong Kong</b> or <b>Colombia</b>).</li>',
                infoVisualTipsTitle: 'üü¢ Visual Tips',
                infoVisualTipsList: '<li><b>Status colors:</b><span style="color:#16a34a;">üü¢ Approved</span> | <span style="color:#eab308;">üü° Pending</span> | <span style="color:#dc2626;">üî¥ Rejected</span> | <span style="color:#3b82f6;">üîµ In progress</span> | <span style="color:#6b7280;">‚ö™ Canceled</span></li><li><b>Flag icons:</b> Indicate the order\'s country of origin.</li>',
                infoGeneralHelp: 'If you need help, click this icon again or consult the user manual.',
                infoOrderDetailsTitle: 'üìÑ Order Details',
                infoOrderDetailsDesc: 'View all detailed information for the selected order:',
                infoOrderDetailsList: '<li><b>General Data:</b> Order number, main ID, origin, supplier, values, and dates.</li><li><b>Order Status:</b> Track progress through visual tracking with steps and colors.</li><li><b>Products:</b> Complete list of items, quantities, and values.</li><li><b>A√ß√µes:</b> Use the button to return to the Order Center.</li>',
                infoOrderDetailsTip: '<b>Tip:</b> Tracking shows each step of the order\'s logistics flow.',
                infoNewRequestFormTitle: 'üìù New Purchase Request',
                infoNewRequestFormDesc: 'Create a new purchase request. Add products and select the origin branch for each one.',
                infoNewRequestFormList: '<li><b>Easy Order:</b> Quickly add products via spreadsheet upload or by pasting codes (for large volumes).</li><li><b>Manual Order:</b> Enter products individually, consulting the catalog if necessary. The <b>Branch</b> (Hong Kong or Colombia) will be selected in the added products table.</li><li><b>Valida√ß√£o:</b> The system automatically validates the minimum purchase quantity (MOQ) for Hong Kong and available stock for Colombia, based on the product\'s branch.</li>',
                infoNewRequestFormTip: '<b>Tip:</b> Stock and MOQ validation is done per product, according to the product\'s branch!',
                infoSummaryScreenTitle: 'üìä Resumo de la Solicitud',
                infoSummaryScreenDesc: 'Revise la divisi√≥n de productos por sucursal y proveedor antes de confirmar.',
                infoSummaryScreenList: '<li><b>Pedidos de Hong Kong:</b> Agrupados por proveedor, con validaci√≥n de MOQ y comparaci√≥n de costos.</li><li><b>Pedidos de Colombia:</b> Un solo pedido para todos los art√≠culos, con detalles de la NF-e simulada.</li><li><b>A√ß√µes:</b> Vuelva para ajustar productos o confirme para generar √≥rdenes de compra.</li>',
                infoSummaryScreenTip: '<b>Consejo:</b> Verifique cuidadosamente la informaci√≥n de MOQ y stock antes de confirmar.',
                infoPurchaseOrderScreenTitle: '‚úÖ Solicitud Generada',
                infoPurchaseOrderScreenDesc: 'Su solicitud ha sido generada y enviada a Compras Internacionales.',
                infoPurchaseOrderScreenList: '<li>Vea los detalles de la PO (Orden de Compra).</li><li>Espere la negociaci√≥n y aprobaci√≥n del gerente.</li><li>Use el bot√≥n para volver al Centro de Pedidos.</li>',
                infoPurchaseOrderScreenTip: '<b>Consejo:</b> Siga el estado del pedido en el Centro de Pedidos.',
                productsAddedToRequestTitle: 'Productos Agregados a la Solicitud:',
                yes: 'S√≠',
                no: 'No',
            },
            'es': {
                centralOrdersTitle: 'Centro de Pedidos',
                newRequestButton: 'Nueva Solicitud',
                logoutButton: 'Cerrar Sesi√≥n',
                statusFilterLabel: 'Estado:',
                allOption: 'Todos',
                statusPending: 'Pendiente',
                statusApproved: 'Aprobado',
                statusRejected: 'Rechazado',
                statusInConference: 'En Conferencia',
                statusDelivered: 'Entregado',
                statusCargoReady: 'Carga Lista',
                statusInDeliveryRoute: 'En Ruta de Entrega',
                statusATD: 'Salida del Puerto de Embarque (ATD)',
                statusATA: 'Llegada al Puerto de Destino (ATA)',
                statusCancelled: 'Cancelado',
                statusNegotiation: 'En Negociaci√≥n',
                statusWaitingApproval: 'Esperando Aprobaci√≥n',
                statusProduction: 'En Producci√≥n',
                statusPendingDoc: 'Documentaci√≥n Pendiente',
                statusDocOk: 'Documentaci√≥n OK',
                statusFinished: 'Finalizado',
                statusSeparation: 'En Separaci√≥n',
                statusInTransit: 'En Ruta de Entrega',
                supplierFilterLabel: 'Proveedor:',
                originCountryFilterLabel: 'Pa√≠s de Origen:',
                searchLabel: 'Buscar por N¬∫ Pedido o Cliente:',
                searchPlaceholder: 'Buscar por N¬∫ Pedido o Cliente',
                colMainRequestId: 'ID SOLICITUD PRINCIPAL',
                colOrderNumber: 'N¬∫ PEDIDO',
                colOrigin: 'ORIGEN',
                colOriginCountry: 'PA√çS ORIGEN',
                colSupplier: 'PROVEEDOR',
                colTotalValue: 'VALOR TOTAL',
                colOrderStatus: 'ESTADO DEL PEDIDO',
                colRequestDate: 'FECHA SOLICITUD/CREACI√ìN',
                colLastChangeDate: 'FECHA √öLTIMA MODIFICACI√ìN',
                noOrdersFound: 'No se encontraron pedidos con los filtros aplicados.',
                orderDetailsTitle: 'Detalles del Pedido',
                generalInfoTitle: 'Informaci√≥n General',
                orderNumberLabel: 'N¬∫ Pedido:',
                mainIdLabel: 'ID Principal:',
                originLabel: 'Origen:',
                supplierLabel: 'Proveedor:',
                totalValueLabel: 'Valor Total:',
                freightLabel: 'FLETE:',
                orderStatusLabel: 'Estado del Pedido:',
                requestCreationDateLabel: 'Fecha Solicitud/Creaci√≥n:',
                lastChangeDateLabel: 'Fecha √öltima Modificaci√≥n:',
                trackingStatusTitle: 'Estado de Seguimiento',
                trackingNotAvailable: 'Seguimiento no disponible para este origen.',
                orderProductsTitle: 'Productos del Pedido',
                colProductCode: 'C√≥digo Producto',
                colDescription: 'Descripci√≥n',
                colQuantity: 'Cantidad',
                colUnitPrice: 'Valor Unitario',
                colTotalItemValue: 'Valor Total Art√≠culo',
                backToOrderCenterButton: 'Volver al Centro de Pedidos',
                CenterButton2: 'Tracking',
                newPurchaseRequestTitle: 'Nueva Solicitud de Compra',
                newPurchaseRequestSubtitle: 'Por favor, complete los detalles de los productos deseados.',
                clientOrderNumberLabel: 'N√∫mero de Pedido del Cliente (Opcional)',
                clientOrderNumberPlaceholder: 'Su n√∫mero de referencia de pedido',
                easyOrderTab: 'Pedido F√°cil',
                manualOrderTab: 'Pedido Manual',
                easyOrderTitle: 'Pedido F√°cil',
                easyOrderSubtitle: 'Elija una de las opciones a continuaci√≥n para agregar productos al carrito de compras',
                uploadSpreadsheetHeader: 'Cargar Hoja de C√°lculo',
                noFileSelected: 'Ning√∫n archivo seleccionado',
                uploadButton: 'Cargar',
                uploadLimitInfo: 'L√≠mite de 50 l√≠neas de productos y 5MB de tama√±o.',
                pasteCodesHeader: 'Copiar y Pegar C√≥digos',
                pasteCodesPlaceholder: 'Pegue aqu√≠ los c√≥digos y cantidades (Ej: COD1,10;COD2,5 o COD1,10 ENTER COD2,5)',
                processCodesButton: 'Procesar C√≥digos Pegados',
                howToUseSpreadsheetTitle: 'Aprenda a usar nuestra plantilla de hoja de c√°lculo',
                step1Title: 'Paso 1',
                step1Description: 'Descargue la plantilla de hoja de c√°lculo. Abra la hoja de c√°lculo en su computadora y complete el c√≥digo de producto del cliente y la cantidad deseada. M√°ximo de 50 l√≠neas de productos por pedido.',
                spreadsheetModelLink: 'Plantilla de Hoja de C√°lculo',
                step2Title: 'Paso 2',
                step2Description: 'Con su hoja de c√°lculo lista y guardada en su computadora, haga clic en Seleccionar archivo. Luego, haga clic en Cargar. El tama√±o de la hoja de c√°lculo no debe exceder los 5MB.',
                step3Title: 'Paso 3',
                step3Description: 'Con su hoja de c√°lculo lista y guardada en su computadora, haga clic en Seleccionar archivo. Luego, haga clic en Cargar. El tama√±o de la hoja de c√°lculo no debe exceder los 5MB.',
                addProductsTitle: 'Agregar Productos',
                clientProductCodeLabel: 'C√≥d. Prod. Cliente:',
                clientProductCodePlaceholder: 'C√≥d. Cliente',
                productCodeLabel: 'C√≥d. Producto:',
                descriptionLabel: 'Descripci√≥n:',
                quantityLabel: 'Cantidad:',
                unitValueLabel: 'Valor Unit.:',
                totalM3Label: 'M¬≥ Total:',
                stockLabel: 'Stock:',
                addProductButton: 'Agregar Producto',
                invalidClientProductCode: 'Error: C√≥digo de producto de cliente inv√°lido.',
                invalidQuantity: 'Error: Por favor, ingrese una cantidad v√°lida para el producto.',
                quantityUpdated: (desc, qty) => `Cantidad de "${desc}" actualizada a ${qty}.`,
                productAdded: (desc) => `"${desc}" agregado exitosamente.`,
                productRemoved: 'Producto eliminado.',
                invalidProductIndex: 'Error: No se pudo eliminar el producto. √çndice inv√°lido.',
                invalidQuantityInput: 'Cantidad inv√°lida. Por favor, ingrese un n√∫mero mayor que cero.',
                qtyBelowMOQWarning: (qty, moq) => `‚ö†Ô∏è Cantidad (${qty}) por debajo del MOQ m√≠nimo (${moq}) para Hong Kong.`,
                qtyMeetsMOQSuccess: (qty, moq) => `‚úÖ Cantidad (${qty}) cumple con el MOQ m√≠nimo (${moq}) para Hong Kong.`,
                qtyExceedsStockError: (qty, stock) => `üö´ Cantidad (${qty}) excede el stock disponible (${stock}) en Colombia.`,
                qtyAvailableStockSuccess: (qty) => `‚úÖ Cantidad (${qty}) disponible en stock en Colombia.`,
                noProductsAdded: 'Ning√∫n producto agregado a√∫n.',
                columbiaStock: 'Stock',
                hongKongMOQContainer: 'MOQ Contenedor',
                selectedBranch: 'Sucursal Seleccionada',
                action: 'Acci√≥n',
                remove: 'Eliminar',
                branchDifferencesTitle: 'Diferencias de Compra por Sucursal:',
                colombiaBranchTitle: 'Colombia',
                colombiaDeliveryTime: 'Previsi√≥n de Entrega: ~45 d√≠as',
                priceModelTitle: 'Modelo de Precio:',
                colombiaPriceModelDesc: 'Precio √∫nico para productos disponibles en stock.',
                colombiaStockInfo: 'Enfoque en productos con stock disponible.',
                hongKongBranchTitle: 'Hong Kong',
                hongKongDeliveryTime: 'Previsi√≥n de Entrega: ~90 d√≠as',
                hongKongPriceModelLCL: '<strong>LCL:</strong> M√°s caro (para vol√∫menes peque√±os)',
                hongKongPriceModel20ft: '<strong>Contenedor 20ft:</strong> Precio intermedio',
                hongKongPriceModel40ft: '<strong>Contenedor 40ft:</strong> M√°s barato (para vol√∫menes mayores)',
                hongKongMOQInfo: 'Para adquirir, es necesario cumplir con el MOQ (Cantidad M√≠nima de Pedido).',
                backButton: 'Volver',
                submitRequestButton: 'Enviar Solicitud',
                addAtLeastOneProduct: 'Por favor, agregue al menos un producto antes de enviar la solicitud.',
                validationErrorsTitle: 'Errores de Validaci√≥n',
                requestSummaryTitle: 'Resumen de la Solicitud',
                requestSummarySubtitle: 'Verifique la divisi√≥n de productos por sucursal y proveedor.',
                backAndAdjustButton: 'Volver y Ajustar',
                confirmAndGenerateButton: 'Confirmar y Generar Pedidos',
                hongKongOrdersTitle: 'Pedidos para Hong Kong',
                moqAttention: 'Atenci√≥n: ¬°Problemas de MOQ detectados!',
                moqError: 'Error: ¬°Art√≠culos cancelados debido a falla de MOQ!',
                supplierDivisionTitle: 'Divisi√≥n por Proveedor (Requisiciones de Compra - POs):',
                poNumberForSupplier: (poId, supplierCode, supplierName) => `PO N¬∫ ${poId} para Proveedor: <strong>${supplierCode} - ${supplierName}</strong>`,
                mainRequestId: 'ID Solicitud Principal:',
                generationDate: 'Fecha de Generaci√≥n:',
                estimatedOrderTotal: 'Valor Total Estimado del Pedido:',
                containerForecast: 'Pron√≥stico de Contenedor:',
                products: 'Productos:',
                colModel: 'Modelo',
                colProductCode: 'C√≥digo',
                colDescription: 'Descripci√≥n',
                colQuantity: 'Cantidad',
                colUnitPrice: 'Precio Unit.',
                colTotalPrice: 'Precio Total',
                colM3Unit: 'M¬≥ Unit.',
                colM3Total: 'M¬≥ Total',
                colContainerPercentage: '% Contenedor',
                cubageForecastTitle: 'Pron√≥stico de Cubicaje por Tipo de Contenedor (Total del Pedido):',
                totalOrderCubage: (cubage) => `Cubicaje Total del Pedido: <strong>${cubage} m¬≥</strong>`,
                containerType: 'Tipo CTN',
                occupationPercentage: '% Ocupaci√≥n',
                totalM3CTN: 'M¬≥ Total CTN',
                priceDisclaimer: 'Los precios presentados son estimaciones y pueden sufrir alteraciones. Se pueden aplicar costos adicionales de flete, impuestos u otras tarifas.',
                colombiaOrderTitle: 'Pedido para Colombia',
                salesOrderDetailsTitle: 'Detalles del Pedido de Venta',
                salesOrderNumberSAP: 'N¬∫ Pedido de Venta SAP:',
                totalValue: 'Valor Total:',
                noSummaryOrders: 'No hay pedidos para mostrar en el resumen.',
                requestSentTitle: 'Solicitud Enviada',
                requestSentMessage: 'Su solicitud ha sido procesada y las √≥rdenes han sido generadas. Puede seguir el estado en el Centro de Pedidos.',
                poDetailsTitle: 'Detalles de la Orden de Compra (PO)',
                viewNFeTitle: 'Ver NF-e',
                nfeContentNotAvailable: 'Contenido de la NF-e no disponible.',
                viewPOPdfTitle: 'Ver PDF de la PO',
                okButton: 'OK',
                cancelButton: 'Cancelar',
                productCatalogTitle: 'Cat√°logo de Productos',
                searchCatalogPlaceholder: 'Buscar por c√≥digo o descripci√≥n...',
                searchButton: 'Buscar',
                closeButton: 'Cerrar',
                catalogClientProductCode: 'C√≥d. Prod. Cliente',
                catalogProductCode: 'C√≥d. Producto',
                catalogDescription: 'Descripci√≥n',
                catalogDefaultBranch: 'Sucursal Predeterminada',
                catalogUnitPrice: 'Precio Unit.',
                catalogMOQ: 'MOQ',
                catalogStock: 'Stock',
                catalogM3Unit: 'M¬≥ Unit.',
                catalogLine: 'L√≠nea',
                uploadSuccess: (filename, added, skipped) => `¬°Carga de "${filename}" completada! ${added} producto(s) agregado(s).${skipped > 0 ? ` ${skipped} art√≠culo(s) omitido(s).` : ''}`,
                uploadFileSelect: 'Por favor, seleccione un archivo para cargar.',
                invalidFileType: 'Tipo de archivo inv√°lido. Por favor, seleccione un archivo Excel (.xlsx, .xls) o CSV.',
                fileSizeExceeded: 'El archivo excede el tama√±o m√°ximo permitido de 5MB.',
                spreadsheetModelDownloaded: '¬°Plantilla de hoja de c√°lculo descargada exitosamente!',
                pasteCodesEmpty: 'Por favor, pegue los c√≥digos y cantidades en el cuadro de texto.',
                codesProcessedSuccess: (added, skipped) => `${added} producto(s) procesado(s) exitosamente.${skipped > 0 ? ` ${skipped} art√≠culo(s) omitido(s).` : ''}`,
                invalidFormatOrProduct: (item) => `Formato inv√°lido o producto/cantidad no encontrado para: "${item}".`,
                expectedFormat: (item) => `Formato inv√°lido para: "${item}". Se esperaba "C√ìDIGO,CANTIDAD".`,
                infoScreenInfoTitle: 'Informaci√≥n de la Pantalla',
                infoCentralOrdersTitle: 'üìÇ Centro de Pedidos',
                infoCentralOrdersDesc: '¬°Bienvenido al <b>Centro de Pedidos</b>! Aqu√≠ puede gestionar y seguir todas las solicitudes de principio a fin.',
                infoSearchFiltersTitle: 'üîç B√∫squeda y Filtros',
                infoSearchFiltersList: '<li>Filtre pedidos por <b>Estado</b>, <b>Proveedor</b> (c√≥digo), <b>Pa√≠s de Origen</b> (Colombia o Hong Kong) o <b>Cliente</b>.</li><li>Utilice la b√∫squeda r√°pida por n√∫mero de pedido, ID principal o nombre del cliente.</li>',
                infoOrdersViewTitle: 'üìã Vista de Pedidos',
                infoOrdersViewList: '<li>Vea todos los pedidos en una tabla detallada.</li><li>Haga clic en el n√∫mero de pedido para acceder a los detalles completos.</li>',
                infoNewRequestTitle: 'üÜï Nueva Solicitud',
                infoNewRequestList: '<li>Haga clic en <b>Nueva Solicitud</b> para iniciar un nuevo pedido, eligiendo la sucursal de destino (<b>Hong Kong</b> o <b>Colombia</b>).</li>',
                infoVisualTipsTitle: 'üü¢ Consejos Visuales',
                infoVisualTipsList: '<li><b>Colores de estado:</b><span style="color:#16a34a;">üü¢ Aprobado</span> | <span style="color:#eab308;">üü° Pendiente</span> | <span style="color:#dc2626;">üî¥ Rechazado</span> | <span style="color:#3b82f6;">üîµ En curso</span> | <span style="color:#6b7280;">‚ö™ Cancelado</span></li><li><b>Iconos de bandera:</b> Indican el pa√≠s de origen del pedido.</li>',
                infoGeneralHelp: 'Si necesita ayuda, haga clic de nuevo en este icono o consulte el manual de usuario.',
                infoOrderDetailsTitle: 'üìÑ Detalles del Pedido',
                infoOrderDetailsDesc: 'Vea toda la informaci√≥n detallada del pedido seleccionado:',
                infoOrderDetailsList: '<li><b>Datos Generales:</b> N√∫mero de pedido, ID principal, origen, proveedor, valores y fechas.</li><li><b>Estado del Pedido:</b> Siga el progreso a trav√©s del seguimiento visual con pasos y colores.</li><li><b>Productos:</b> Lista completa de art√≠culos, cantidades y valores.</li><li><b>Acciones:</b> Utilice el bot√≥n para volver al Centro de Pedidos.</li>',
                infoOrderDetailsTip: '<b>Consejo:</b> El seguimiento muestra cada paso del flujo log√≠stico del pedido.',
                infoNewRequestFormTitle: 'üìù Nueva Solicitud de Compra',
                infoNewRequestFormDesc: 'Cree una nueva solicitud de compra. Agregue productos y seleccione la sucursal de origen para cada uno.',
                infoNewRequestFormList: '<li><b>Pedido F√°cil:</b> Agregue productos r√°pidamente mediante la carga de una hoja de c√°lculo o pegando c√≥digos (para grandes vol√∫menes).</li><li><b>Pedido Manual:</b> Ingrese productos individualmente, consultando el cat√°logo si es necesario. La <b>Sucursal</b> (Hong Kong o Colombia) se seleccionar√° en la tabla de productos agregados.</li><li><b>Validaci√≥n:</b> El sistema valida autom√°ticamente la cantidad m√≠nima de compra (MOQ) para Hong Kong y el stock disponible para Colombia, seg√∫n la sucursal del producto.</li>',
                infoNewRequestFormTip: '<b>Consejo:</b> ¬°La validaci√≥n de stock y MOQ se realiza por producto, seg√∫n la sucursal del producto!',
                infoSummaryScreenTitle: 'üìä Resumen de la Solicitud',
                infoSummaryScreenDesc: 'Revise la divisi√≥n de productos por sucursal y proveedor antes de confirmar.',
                infoSummaryScreenList: '<li><b>Pedidos de Hong Kong:</b> Agrupados por proveedor, con validaci√≥n de MOQ y comparaci√≥n de costos.</li><li><b>Pedidos de Colombia:</b> Un solo pedido para todos los art√≠culos, con detalles de la NF-e simulada.</li><li><b>Acciones:</b> Vuelva para ajustar productos o confirme para generar √≥rdenes de compra.</li>',
                infoSummaryScreenTip: '<b>Consejo:</b> Verifique cuidadosamente la informaci√≥n de MOQ y stock antes de confirmar.',
                infoPurchaseOrderScreenTitle: '‚úÖ Solicitud Generada',
                infoPurchaseOrderScreenDesc: 'Su solicitud ha sido generada y enviada a Compras Internacionales.',
                infoPurchaseOrderScreenList: '<li>Vea los detalles de la PO (Orden de Compra).</li><li>Espere la negociaci√≥n y aprobaci√≥n del gerente.</li><li>Use el bot√≥n para volver al Centro de Pedidos.</li>',
                infoPurchaseOrderScreenTip: '<b>Consejo:</b> Siga el estado del pedido en el Centro de Pedidos.',
                productsAddedToRequestTitle: 'Productos Agregados a la Solicitud:',
                yes: 'S√≠',
                no: 'No',
            }
        };

        let currentLanguage = 'pt-BR';

        /**
         * Define o idioma da interface e atualiza todos os elementos traduz√≠veis.
         * @param {string} lang - O c√≥digo do idioma (ex: 'pt-BR', 'en', 'es').
         */
        function setLanguage(lang) {
            currentLanguage = lang;
            document.documentElement.lang = lang;

            // Atualiza textos e placeholders com base nos atributos data-translate
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[lang] && translations[lang][key]) { // Adicionado verifica√ß√£o para translations[lang]
                    // Usa innerHTML para permitir tags como <strong>
                    element.innerHTML = translations[lang][key];
                }
            });

            document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
                const key = element.getAttribute('data-translate-placeholder');
                if (translations[lang] && translations[lang][key]) { // Adicionado verifica√ß√£o para translations[lang]
                    element.placeholder = translations[lang][key];
                }
            });

            // Atualiza as op√ß√µes de status no filtro
            const statusSelect = document.getElementById('status');
            if (statusSelect) {
                Array.from(statusSelect.options).forEach(option => {
                    const value = option.value;
                    if (value === 'Todos') {
                        option.innerText = translations[lang]['allOption'];
                    } else {
                        // Mapeia o valor do status para a chave de tradu√ß√£o
                        option.innerText = getTranslatedStatus(value);
                    }
                });
            }

            // Atualiza os seletores de idioma em todas as telas
            const languageSelectors = document.querySelectorAll('select[id^="language-selector-"]');
            languageSelectors.forEach(selector => {
                selector.value = lang;
            });

            // Atualiza conte√∫do din√¢mico que n√£o √© coberto por data-translate
            renderOrdersTable();
            if (currentScreen === 'orderDetailsScreen' && currentOrderDetails) {
                viewOrderDetails(currentOrderDetails.orderId);
            }
            if (currentScreen === 'newOrderFormScreen') {
                updateProductDetailsOnClientCodeChange();
                renderProductList();
            }
            if (currentScreen === 'summaryScreen') {
                renderUnifiedSummary();
            }
        }

        /**
         * Retorna a string de status traduzida com base na chave.
         * @param {string} statusKey - A chave do status (ex: 'Pendente', 'Aprovado').
         * @returns {string} O status traduzido.
         */
        function getTranslatedStatus(statusKey) {
            const statusMap = {
                'Todos': 'allOption',
                'Pendente': 'statusPending',
                'Aprovado': 'statusApproved',
                'Rejeitado': 'statusRejected',
                'Em Confer√™ncia': 'statusInConference',
                'Entregue': 'statusDelivered',
                'Carga Pronta': 'statusCargoReady',
                'Em Rota de Entrega': 'statusInDeliveryRoute',
                'Sa√≠da do Porto de Embarque (ATD)': 'statusATD',
                'Chegada no Porto de Destino (ATA)': 'statusATA',
                'Cancelado': 'statusCancelled',
                'Em Negocia√ß√£o': 'statusNegotiation',
                'Aguardando Aprova√ß√£o': 'statusWaitingApproval',
                'Em Produ√ß√£o': 'statusProduction',
                'Documenta√ß√£o Pendente': 'statusPendingDoc',
                'Documenta√ß√£o OK': 'statusDocOk',
                'Finalizado': 'statusFinished',
                'Em Separa√ß√£o': 'statusSeparation',
                'Em Rota de Entrega': 'statusInTransit', // Reafirmando para clareza
            };
            const translationKey = statusMap[statusKey];
            return translations[currentLanguage][translationKey] || statusKey; // Retorna a chave original se n√£o houver tradu√ß√£o
        }

        /**
         * Exibe uma tela espec√≠fica e oculta as outras.
         * @param {string} screenId - O ID da tela a ser exibida.
         */
        function showScreen(screenId) {
            document.querySelectorAll('.page').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
            currentScreen = screenId;
        }

        /**
         * Exibe um modal de mensagem gen√©rico.
         * @param {string} title - T√≠tulo do modal.
         * @param {string} content - Conte√∫do HTML do modal.
         * @param {string} type - Tipo da mensagem (info, success, error).
         * @param {function} onConfirm - Callback para o bot√£o de confirma√ß√£o.
         * @param {function} onCancel - Callback para o bot√£o de cancelamento.
         */
        function showMessage(title, content, type = 'info', onConfirm = null, onCancel = null) {
            const modal = document.getElementById('messageModal');
            document.getElementById('messageModalTitle').innerText = title;
            document.getElementById('messageModalContent').innerHTML = content; // Usar innerHTML para permitir HTML no conte√∫do
            const confirmBtn = document.getElementById('messageModalConfirmBtn');
            const cancelBtn = document.getElementById('messageModalCancelBtn');
            const closeBtn = document.getElementById('messageModalCloseBtn');

            confirmBtn.onclick = () => { if (onConfirm) onConfirm(); modal.classList.remove('active'); };
            cancelBtn.onclick = () => { if (onCancel) onCancel(); modal.classList.remove('active'); };
            closeBtn.onclick = () => modal.classList.remove('active');

            confirmBtn.classList.add('hidden');
            cancelBtn.classList.add('hidden');
            closeBtn.classList.remove('hidden');

            if (onConfirm || onCancel) {
                closeBtn.classList.add('hidden');
                confirmBtn.classList.remove('hidden');
                if (onCancel) {
                    cancelBtn.classList.remove('hidden');
                }
            }
            modal.classList.add('active');
        }

        /**
         * Exibe uma mensagem tempor√°ria de adi√ß√£o de produto.
         * @param {string} message - A mensagem a ser exibida.
         * @param {string} type - O tipo da mensagem (success, error, warning, info).
         */
        function displayAddProductMessage(message, type) {
            const messageDiv = document.getElementById('addProductMessage');
            messageDiv.innerText = message;
            messageDiv.className = `validation-message ${type}`;
            messageDiv.style.display = 'block';
            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 3000);
        }

        /**
         * Obt√©m ou gera um c√≥digo de fornecedor.
         * @param {string} supplierName - Nome do fornecedor.
         * @returns {string} C√≥digo do fornecedor.
         */
        function getOrGenerateSupplierCode(supplierName) {
            if (!supplierCodeMap[supplierName]) {
                supplierCodeMap[supplierName] = String(nextSupplierCode);
                supplierNameMap[String(nextSupplierCode)] = supplierName;
                nextSupplierCode += 11;
            }
            return supplierCodeMap[supplierName];
        }

        /**
         * Obt√©m o nome do fornecedor a partir do c√≥digo.
         * @param {string} supplierCode - C√≥digo do fornecedor.
         * @returns {string} Nome do fornecedor.
         */
        function getSupplierNameFromCode(supplierCode) {
            return supplierNameMap[supplierCode] || supplierCode;
        }

        /**
         * Cria uma se√ß√£o HTML para o modal de informa√ß√µes.
         * @param {string} titleKey - Chave de tradu√ß√£o para o t√≠tulo.
         * @param {string} descKey - Chave de tradu√ß√£o para a descri√ß√£o.
         * @param {Array<Object|string>} listItems - Lista de itens para o corpo da se√ß√£o.
         * @returns {string} HTML da se√ß√£o.
         */
        function createInfoSection(titleKey, descKey, listItems = []) {
            let html = `<h2 style="font-size:1.3rem; font-weight:bold; margin-bottom:10px;">${translations[currentLanguage][titleKey]}</h2>`;
            if (descKey) {
                html += `<p>${translations[currentLanguage][descKey]}</p>`;
            }
            listItems.forEach(item => {
                if (typeof item === 'string') {
                    html += `<hr style="margin:16px 0;"><p style="font-size:0.95rem;">${translations[currentLanguage][item]}</p>`;
                } else if (item.type === 'h3') {
                    html += `<hr style="margin:16px 0;"><h3 style="font-size:1.1rem; font-weight:bold;">${translations[currentLanguage][item.key]}</h3>`;
                } else if (item.type === 'ul') {
                    html += `<ul style="margin-bottom:10px;">${translations[currentLanguage][item.key]}</ul>`;
                }
            });
            return html;
        }

        /**
         * Exibe informa√ß√µes da tela atual em um modal.
         */
        function showScreenInfo() {
            let infoHtml = '';
            switch (currentScreen) {
                case 'central-pedidos-page':
                    infoHtml = createInfoSection('infoCentralOrdersTitle', 'infoCentralOrdersDesc', [
                        { type: 'h3', key: 'infoSearchFiltersTitle' }, { type: 'ul', key: 'infoSearchFiltersList' },
                        { type: 'h3', key: 'infoOrdersViewTitle' }, { type: 'ul', key: 'infoOrdersViewList' },
                        { type: 'h3', key: 'infoNewRequestTitle' }, { type: 'ul', key: 'infoNewRequestList' },
                        { type: 'h3', key: 'infoVisualTipsTitle' }, { type: 'ul', key: 'infoVisualTipsList' },
                        'infoGeneralHelp'
                    ]);
                    break;
                case 'orderDetailsScreen':
                    infoHtml = createInfoSection('infoOrderDetailsTitle', 'infoOrderDetailsDesc', [
                        { type: 'ul', key: 'infoOrderDetailsList' },
                        'infoOrderDetailsTip'
                    ]);
                    break;
                case 'newOrderFormScreen':
                    infoHtml = createInfoSection('infoNewRequestFormTitle', 'infoNewRequestFormDesc', [
                        { type: 'ul', key: 'infoNewRequestFormList' },
                        'infoNewRequestFormTip'
                    ]);
                    break;
                case 'summaryScreen':
                    infoHtml = createInfoSection('infoSummaryScreenTitle', 'infoSummaryScreenDesc', [
                        { type: 'ul', key: 'infoSummaryScreenList' },
                        'infoSummaryScreenTip'
                    ]);
                    break;
                case 'purchaseOrderScreen':
                    infoHtml = createInfoSection('infoPurchaseOrderScreenTitle', 'infoPurchaseOrderScreenDesc', [
                        { type: 'ul', key: 'infoPurchaseOrderScreenList' },
                        'infoPurchaseOrderScreenTip'
                    ]);
                    break;
                default:
                    infoHtml = '<p>Esta tela faz parte do fluxo do portal. Para mais informa√ß√µes, consulte o manual ou o suporte.</p>';
            }
            showMessage(translations[currentLanguage]['infoScreenInfoTitle'] || 'Informa√ß√µes da Tela', infoHtml, 'info');
        }

        /**
         * Realiza o logout do usu√°rio.
         */
        function logout() {
            productsInCurrentOrder = [];
            simulatedSupplierOrders = {};
            simulatedColombiaOrder = null;
            currentOrderDetails = null;
            currentViewingPO = null;
            currentPurchasingPO = null;
            window.location.href = 'index.html';
        }

        /**
         * Popula o filtro de fornecedores.
         */
        function populateSupplierFilter() {
            const supplierFilterSelect = document.getElementById('fornecedor');
            supplierFilterSelect.innerHTML = `<option value="Todos">${translations[currentLanguage]['allOption']}</option>`;

            const uniqueSuppliers = new Set();
            orders.forEach(order => {
                if (order.supplier) {
                    uniqueSuppliers.add(order.supplier);
                }
            });

            const sortedSupplierCodes = Array.from(Object.keys(supplierNameMap)).sort((a, b) => parseInt(a) - parseInt(b));

            sortedSupplierCodes.forEach(supplierCode => {
                const option = document.createElement('option');
                option.value = supplierCode;
                option.innerText = `${supplierCode}`;
                supplierFilterSelect.appendChild(option);
            });
        }

        /**
         * Popula o filtro de pa√≠s de origem.
         */
        function populateOriginCountryFilter() {
            const originCountryFilterSelect = document.getElementById('paisOrigem');
            originCountryFilterSelect.innerHTML = `<option value="Todos">${translations[currentLanguage]['allOption']}</option>`;

            const uniqueCountries = new Set();
            orders.forEach(order => {
                if (order.originCountry) {
                    uniqueCountries.add(order.originCountry);
                }
            });

            Array.from(uniqueCountries).sort().forEach(country => {
                const option = document.createElement('option');
                option.value = country;
                option.innerText = country;
                originCountryFilterSelect.appendChild(option);
            });
        }

        /**
         * Renderiza a tabela de pedidos com base nos filtros.
         */
        function renderOrdersTable() {
            const tbody = document.querySelector('#central-pedidos-page table tbody');
            tbody.innerHTML = '';

            const statusFilter = document.getElementById('status').value;
            const supplierFilterCode = document.getElementById('fornecedor').value;
            const originCountryFilter = document.getElementById('paisOrigem').value;
            const orderSearchQuery = document.getElementById('search').value.toLowerCase();

            const getFlagImage = (country) => {
                if (!country || typeof country !== 'string') return '<span class="flag-icon">üö©</span>';
                switch(country.toLowerCase()) {
                    case 'col√¥mbia': return '<img src="https://e7.pngegg.com/pngimages/796/10/png-clipart-flag-of-colombia-flag-of-cambodia-colombia-flag-flag-sphere-thumbnail.png" alt="Bandeira da Col√¥mbia" class="flag-icon">';
                    case 'hong kong': return '<img src="https://e7.pngegg.com/pngimages/630/750/png-clipart-flag-of-china-association-of-southeast-asian-nations-national-flag-asean%E3%81%AE%E7%B4%8B%E7%AB%A0-china-orange-world-thumbnail.png" alt="Bandeira de Hong Kong" class="flag-icon">';
                    default: return '<span class="flag-icon">üö©</span>';
                }
            };

            let filteredOrders = orders.filter(order => {
                const matchesStatus = statusFilter === 'Todos' || order.status === statusFilter;
                const matchesSupplier = supplierFilterCode === 'Todos' || getOrGenerateSupplierCode(order.supplier) === supplierFilterCode;
                const matchesOriginCountry = originCountryFilter === 'Todos' || order.originCountry === originCountryFilter;
                const matchesSearch = orderSearchQuery === '' ||
                                      order.orderId.toLowerCase().includes(orderSearchQuery) ||
                                      (order.parentOrderId && order.parentOrderId.toLowerCase().includes(orderSearchQuery)) ||
                                      (order.clientFlag && order.clientFlag.toLowerCase().includes(orderSearchQuery));
                return matchesStatus && matchesSupplier && matchesOriginCountry && matchesSearch;
            });

            filteredOrders.sort((a, b) => {
                const idA = (a.parentOrderId && typeof a.parentOrderId === 'string') ? parseInt(a.parentOrderId.replace('SOL-', '')) : 0;
                const idB = (b.parentOrderId && typeof b.parentOrderId === 'string') ? parseInt(b.parentOrderId.replace('SOL-', '')) : 0;
                return idA - idB;
            });

            if (filteredOrders.length === 0) {
                tbody.innerHTML = `<tr><td colspan="9" class="text-center py-4 text-gray-500">${translations[currentLanguage]['noOrdersFound']}</td></tr>`;
                return;
            }

            filteredOrders.forEach(order => {
                const row = document.createElement('tr');
                let statusIndicatorClass = '';
                switch (order.status) {
                    case 'Aprovado': case 'Carga Pronta': case 'Documenta√ß√£o OK': case 'Chegada no Porto de Destino (ATA)': case 'Entregue': case 'Negociado': case 'Finalizado': case 'Em Produ√ß√£o':
                        statusIndicatorClass = 'green'; break;
                    case 'Pendente': case 'Aguardando Aprova√ß√£o': case 'Em Negocia√ß√£o': case 'Documenta√ß√£o Pendente':
                        statusIndicatorClass = 'yellow'; break;
                    case 'Rejeitado':
                        statusIndicatorClass = 'red'; break;
                    case 'Sa√≠da do Porto de Embarque (ATD)': case 'Em Separa√ß√£o': case 'Em Confer√™ncia': case 'Em Rota de Entrega':
                        statusIndicatorClass = 'blue'; break;
                    case 'Cancelado':
                        statusIndicatorClass = 'gray'; break;
                    default:
                        statusIndicatorClass = 'yellow';
                }

                const flagImageHtml = getFlagImage(order.originCountry);
                const displaySupplierInfo = order.supplier ? getOrGenerateSupplierCode(order.supplier) : 'N/A';

                row.innerHTML = `
                    <td>${order.parentOrderId || 'N/A'}</td>
                    <td><a href="#" class="pedido-link" onclick="viewOrderDetails('${order.orderId}')">${order.orderId}</a></td>
                    <td>${flagImageHtml}</td>
                    <td>${order.originCountry}</td>
                    <td>${displaySupplierInfo}</td>
                    <td>$ ${(order.totalValue || 0).toFixed(2).replace('.', ',')}</td>
                    <td><span class="status-indicator ${statusIndicatorClass}"></span>${getTranslatedStatus(order.status)}</td>
                    <td>${order.requestDate}</td>
                    <td>${order.lastUpdateDate}</td>
                `;
                tbody.appendChild(row);
            });
        }

        /**
         * Exibe os detalhes de um pedido espec√≠fico.
         * @param {string} orderId - O ID do pedido a ser visualizado.
         */
        function viewOrderDetails(orderId) {
            // Move showScreen to the beginning to ensure elements are visible before populating
            showScreen('orderDetailsScreen');

            currentOrderDetails = orders.find(order => order.orderId === orderId);
            if (!currentOrderDetails) {
                showMessage(translations[currentLanguage]['errorTitle'] || 'Erro', translations[currentLanguage]['orderDetailsNotFound'] || 'Detalhes do pedido n√£o encontrados.', 'error');
                return;
            }

            const currentOrderIdElement = document.getElementById('currentOrderId');
            if (currentOrderIdElement) {
                currentOrderIdElement.innerText = currentOrderDetails.orderId;
            }

            const detailOrderIdElement = document.getElementById('detailOrderId');
            if (detailOrderIdElement) {
                detailOrderIdElement.innerText = currentOrderDetails.orderId;
            }

            const detailParentOrderIdElement = document.getElementById('detailParentOrderId');
            if (detailParentOrderIdElement) {
                detailParentOrderIdElement.innerText = currentOrderDetails.parentOrderId || 'N/A';
            }

            const getFlagImageForDetails = (country) => {
                if (!country || typeof country !== 'string') return '<span class="mr-2 flag-icon">üö©</span>';
                switch(country.toLowerCase()) {
                    case 'col√¥mbia': return '<img src="https://e7.pngegg.com/pngimages/796/10/png-clipart-flag-of-colombia-flag-of-cambodia-colombia-flag-flag-sphere-thumbnail.png" alt="Bandeira da Col√¥mbia" class="flag-icon inline-block mr-2">';
                    case 'hong kong': return '<img src="https://e7.pngegg.com/pngimages/630/750/png-clipart-flag-of-china-association-of-southeast-asian-nations-national-flag-asean%E3%81%AE%E7%B4%8B%E7%AB%A0-china-orange-world-thumbnail.png" alt="Bandeira de Hong Kong" class="flag-icon inline-block mr-2">';
                    default: return '<span class="mr-2 flag-icon">üö©</span>';
                }
            };
            const detailOriginDisplayElement = document.getElementById('detailOriginDisplay');
            if (detailOriginDisplayElement) {
                detailOriginDisplayElement.innerHTML = `${getFlagImageForDetails(currentOrderDetails.originCountry)}${currentOrderDetails.originCountry}`;
            }

            const detailSupplierElement = document.getElementById('detailSupplier');
            if (detailSupplierElement) {
                detailSupplierElement.innerText = currentOrderDetails.supplier ? getOrGenerateSupplierCode(currentOrderDetails.supplier) : 'N/A';
            }

            const detailTotalValueElement = document.getElementById('detailTotalValue');
            if (detailTotalValueElement) {
                detailTotalValueElement.innerText = `$ ${(currentOrderDetails.totalValue || 0).toFixed(2).replace('.', ',')}`;
            }

            const orderTotalCubage = currentOrderDetails.products.reduce((sum, product) => {
                const productInfo = productDatabase[product.code];
                return sum + (productInfo ? productInfo.cubageUnit * product.quantity : 0);
            }, 0);
            const detailFreightElement = document.getElementById('detailFreight');
            if (detailFreightElement) {
                detailFreightElement.innerText = getContainerSuggestion(orderTotalCubage);
            }

            const detailStatusElement = document.getElementById('detailStatus');
            if (detailStatusElement) {
                detailStatusElement.innerText = getTranslatedStatus(currentOrderDetails.status); // Traduz o status
            }

            const detailRequestDateElement = document.getElementById('detailRequestDate');
            if (detailRequestDateElement) {
                detailRequestDateElement.innerText = currentOrderDetails.requestDate;
            }

            const detailLastUpdateDateElement = document.getElementById('detailLastUpdateDate');
            if (detailLastUpdateDateElement) {
                detailLastUpdateDateElement.innerText = currentOrderDetails.lastUpdateDate;
            }

            const productsTableBody = document.getElementById('orderDetailsProductsTableBody');
            if (productsTableBody) { // Add null check here too
                productsTableBody.innerHTML = '';

                currentOrderDetails.products.forEach(product => {
                    const row = document.createElement('tr');
                    const itemTotalPrice = (product.quantity * product.unitPrice).toFixed(2);
                    row.innerHTML = `
                        <td>${product.code}</td>
                        <td>${product.description}</td>
                        <td>${product.quantity}</td>
                        <td>$ ${product.unitPrice.toFixed(2).replace('.', ',')}</td>
                        <td>$ ${itemTotalPrice.replace('.', ',')}</td>
                    `;
                    productsTableBody.appendChild(row);
                });
            }

            renderTracking(currentOrderDetails);
        }

        /**
         * Renderiza o rastreamento do pedido com base no fluxo de status.
         * @param {Object} order - O objeto do pedido.
         */
        function renderTracking(order) {
            const trackingSection = document.getElementById('orderTrackingSection');
            trackingSection.innerHTML = '';

            let flow = [];
            if (order.originCountry === 'Hong Kong') flow = hongKongTrackingFlow;
            else if (order.originCountry === 'Col√¥mbia') flow = colombiaTrackingFlow;
            else {
                trackingSection.innerHTML = `<p class="text-gray-500 text-center">${translations[currentLanguage]['trackingNotAvailable']}</p>`;
                return;
            }

            let currentStatusIndex = flow.findIndex(step => getTranslatedStatus(order.status) === translations[currentLanguage][step.nameKey]);
            let trackingHtml = '<div class="tracking-steps">';

            flow.forEach((step, index) => {
                let stepClass = '';
                let circleContent = '';

                if (index < currentStatusIndex) stepClass = 'completed';
                else if (index === currentStatusIndex) stepClass = 'active';
                else stepClass = 'future';

                if (stepClass === 'completed' || stepClass === 'active') {
                    if (step.class) stepClass += ` ${step.class}`;
                }

                if (stepClass.includes('completed')) circleContent = '&#10003;';
                else if (stepClass.includes('active')) circleContent = (index + 1).toString();

                trackingHtml += `
                    <div class="tracking-step ${stepClass}">
                        <div class="circle">${circleContent}</div>
                        <span>${translations[currentLanguage][step.nameKey] || step.nameKey}</span>
                    </div>
                `;
            });
            trackingHtml += '</div>';
            trackingSection.innerHTML = trackingHtml;
        }

        /**
         * Reseta o formul√°rio de nova solicita√ß√£o.
         */
        function resetNewOrderForm() {
            document.getElementById('clientOrderNumber').value = '';
            productsInCurrentOrder = [];
            renderProductList();

            document.getElementById('easyOrderTab').classList.add('active');
            document.getElementById('manualOrderTab').classList.remove('active');

            document.getElementById('clientProductCode').value = '';
            document.getElementById('mappedProductCodeDisplay').value = '--';
            document.getElementById('productDescriptionDisplay').value = '--';
            document.getElementById('productQuantity').value = '1';
            document.getElementById('validationFeedback').innerText = '';
            document.getElementById('productValueDisplay').value = '$ 0,00';
            document.getElementById('totalM3Display').value = '0.00 m¬≥';
            document.getElementById('valorTotalDisplay').value = '$ 0,00'; // Corrigido para moeda
            document.getElementById('productStockDisplay').value = '--';

            document.getElementById('totalM3Group').style.display = 'none';
            document.getElementById('valorTotalGroup').style.display = 'none';
            document.getElementById('productStockGroup').style.display = 'none';

            document.getElementById('fileUpload').value = '';
            document.getElementById('fileNameDisplay').innerText = translations[currentLanguage]['noFileSelected'];
            document.getElementById('pasteCodes').value = '';
            document.getElementById('addProductMessage').style.display = 'none';

            const uploadPlanilhaContent = document.getElementById('uploadPlanilhaContent');
            const pasteCodesContent = document.getElementById('pasteCodesContent');
            const uploadPlanilhaHeader = uploadPlanilhaContent.previousElementSibling;
            const pasteCodesHeader = pasteCodesContent.previousElementSibling;

            if (uploadPlanilhaContent.classList.contains('active')) toggleCollapsible(uploadPlanilhaHeader, 'uploadPlanilhaContent');
            if (pasteCodesContent.classList.contains('active')) toggleCollapsible(pasteCodesHeader, 'pasteCodesContent');

            switchOrderFormTab('easy');
        }

        /**
         * Atualiza a visibilidade dos campos do produto manual com base na filial.
         * @param {string} productBranch - Filial do produto ('Hong Kong' ou 'Col√¥mbia').
         */
        function updateManualProductFieldsVisibility(productBranch) {
            const totalM3Group = document.getElementById('totalM3Group');
            const valorTotalGroup = document.getElementById('valorTotalGroup');
            const productStockGroup = document.getElementById('productStockGroup');

            if (totalM3Group) {
                if (productBranch === 'Hong Kong') {
                    totalM3Group.style.display = 'block';
                } else {
                    totalM3Group.style.display = 'none';
                }
            }

            if (valorTotalGroup) {
                if (productBranch === 'Col√¥mbia') {
                    valorTotalGroup.style.display = 'block';
                } else {
                    valorTotalGroup.style.display = 'none';
                }
            }

            if (productStockGroup) {
                if (productBranch === 'Col√¥mbia') {
                    productStockGroup.style.display = 'block';
                } else {
                    productStockGroup.style.display = 'none';
                }
            }
        }

        /**
         * Alterna entre as abas do formul√°rio de pedido.
         * @param {string} tabType - O tipo da aba ('easy' ou 'manual').
         */
        function switchOrderFormTab(tabType) {
            document.getElementById('manualOrderTab').classList.remove('active');
            document.getElementById('easyOrderTab').classList.remove('active');

            Array.from(document.getElementById('orderFormTabButtons').children).forEach(button => {
                button.classList.remove('active');
            });

            if (tabType === 'easy') {
                document.getElementById('easyOrderTab').classList.add('active');
                document.getElementById('orderFormTabButtons').children[0].classList.add('active');
            } else if (tabType === 'manual') {
                document.getElementById('manualOrderTab').classList.add('active');
                document.getElementById('orderFormTabButtons').children[1].classList.add('active');
                updateProductDetailsOnClientCodeChange();
            }
        }

        /**
         * Retorna para a tela da Central de Pedidos.
         */
        function backToOrderCenter() {
            showScreen('central-pedidos-page');
            renderOrdersTable();
        }

        /**
         * Retorna para a tela de entrada de produtos.
         */
        function backToProductEntry() {
            showScreen('newOrderFormScreen');
            resetNewOrderForm();
            renderProductList();
        }

        /**
         * Fecha o modal do cat√°logo de produtos.
         */
        function closeProductCatalogModal() {
            document.getElementById('productCatalogModal').classList.remove('active');
        }

        /**
         * Atualiza os detalhes do produto ao mudar o c√≥digo do cliente.
         */
        function updateProductDetailsOnClientCodeChange() {
            const clientProductCodeInput = document.getElementById('clientProductCode').value.trim().toUpperCase();
            const mappedProductCodeDisplay = document.getElementById('mappedProductCodeDisplay');
            const productDescriptionDisplay = document.getElementById('productDescriptionDisplay');
            const productValueDisplay = document.getElementById('productValueDisplay');
            const totalM3Display = document.getElementById('totalM3Display');
            const valorTotalDisplay = document.getElementById('valorTotalDisplay');
            const productStockDisplay = document.getElementById('productStockDisplay');
            const validationFeedbackDiv = document.getElementById('validationFeedback');
            const productQuantityInput = document.getElementById('productQuantity');

            mappedProductCodeDisplay.value = '--';
            productDescriptionDisplay.value = '--';
            productValueDisplay.value = '$ 0,00';
            totalM3Display.value = '0.00 m¬≥';
            valorTotalDisplay.value = '$ 0,00'; // Corrigido para moeda
            productStockDisplay.value = '--';
            validationFeedbackDiv.innerText = '';
            validationFeedbackDiv.className = 'text-xs mt-1';
            productStockDisplay.style.color = '';

            const productCode = universalClientCodeToProductCodeMap[clientProductCodeInput];
            const productInfo = productDatabase[productCode];

            if (productInfo) {
                mappedProductCodeDisplay.value = productCode;
                productDescriptionDisplay.value = productInfo.description;
                productDescriptionDisplay.style.color = '#374151';
                productValueDisplay.value = `$ ${productInfo.tableValue.toFixed(2).replace('.', ',')}`;

                updateManualProductFieldsVisibility(productInfo.originCountry);

                if (productInfo.originCountry === 'Hong Kong') {
                    totalM3Display.value = `${(productInfo.cubageUnit * parseInt(productQuantityInput.value || 1)).toFixed(2).replace('.', ',')} m¬≥`;
                } else if (productInfo.originCountry === 'Col√¥mbia') {
                    productStockDisplay.value = productInfo.simulatedStock > 0 ? translations[currentLanguage]['yes'] : translations[currentLanguage]['no'];
                    productStockDisplay.style.color = productInfo.simulatedStock > 0 ? '#16a34a' : '#dc2626';
                    valorTotalDisplay.value = `$ ${(productInfo.tableValue * parseInt(productQuantityInput.value || 1)).toFixed(2).replace('.', ',')}`;
                }
                handleQuantityChange();
            } else {
                productDescriptionDisplay.value = translations[currentLanguage]['invalidClientProductCode'];
                productDescriptionDisplay.style.color = '#dc2626';
                updateManualProductFieldsVisibility(''); // Hide fields if product not found
            }
        }

        /**
         * Lida com a mudan√ßa na quantidade do produto.
         */
        function handleQuantityChange() {
            const clientProductCode = document.getElementById('clientProductCode').value.trim().toUpperCase();
            const productCode = universalClientCodeToProductCodeMap[clientProductCode];
            const productInfo = productDatabase[productCode];
            const quantity = parseInt(document.getElementById('productQuantity').value);
            const validationFeedbackDiv = document.getElementById('validationFeedback');
            const totalM3Display = document.getElementById('totalM3Display');
            const valorTotalDisplay = document.getElementById('valorTotalDisplay');

            validationFeedbackDiv.innerText = '';
            validationFeedbackDiv.className = 'text-xs mt-1';

            if (!productInfo) {
                validationFeedbackDiv.innerText = translations[currentLanguage]['invalidQuantity'] || 'Por favor, insira um c√≥digo de produto v√°lido.';
                validationFeedbackDiv.className = 'validation-message status-error';
                return;
            }

            if (isNaN(quantity) || quantity <= 0) {
                validationFeedbackDiv.innerText = translations[currentLanguage]['invalidQuantityInput'];
                validationFeedbackDiv.className = 'validation-message status-error';
                totalM3Display.value = '0.00 m¬≥';
                valorTotalDisplay.value = '$ 0,00';
                return;
            }

            if (productInfo.originCountry === 'Hong Kong') {
                const totalM3 = productInfo.cubageUnit * quantity;
                totalM3Display.value = `${totalM3.toFixed(2).replace('.', ',')} m¬≥`;
                if (quantity < productInfo.moq) {
                    validationFeedbackDiv.innerText = translations[currentLanguage]['qtyBelowMOQWarning'](quantity, productInfo.moq);
                    validationFeedbackDiv.className = 'validation-message status-warning';
                } else {
                    validationFeedbackDiv.innerText = translations[currentLanguage]['qtyMeetsMOQSuccess'](quantity, productInfo.moq);
                    validationFeedbackDiv.className = 'validation-message status-ok';
                }
            } else if (productInfo.originCountry === 'Col√¥mbia') {
                const total = productInfo.tableValue * quantity;
                valorTotalDisplay.value = `$ ${(total).toFixed(2).replace('.', ',')}`;
                if (quantity > productInfo.simulatedStock) {
                    validationFeedbackDiv.innerText = translations[currentLanguage]['qtyExceedsStockError'](quantity, productInfo.simulatedStock);
                    validationFeedbackDiv.className = 'validation-message status-error';
                } else {
                    validationFeedbackDiv.innerText = translations[currentLanguage]['qtyAvailableStockSuccess'](quantity);
                    validationFeedbackDiv.className = 'validation-message status-ok';
                }
            }
        }

        /**
         * Adiciona um produto √† lista de produtos do pedido atual.
         */
        function addProduct() {
            const clientProductCode = document.getElementById('clientProductCode').value.trim().toUpperCase();
            const productCode = universalClientCodeToProductCodeMap[clientProductCode];
            const quantity = parseInt(document.getElementById('productQuantity').value);
            const productInfo = productDatabase[productCode];

            if (!productInfo) {
                displayAddProductMessage(translations[currentLanguage]['invalidClientProductCode'], 'error');
                return;
            }

            if (isNaN(quantity) || quantity <= 0) {
                displayAddProductMessage(translations[currentLanguage]['invalidQuantity'], 'error');
                return;
            }

            const totalM3 = (productInfo.cubageUnit * quantity);
            const totalValue = (productInfo.tableValue * quantity);

            const existingProductIndex = productsInCurrentOrder.findIndex(p => p.code === productCode);
            if (existingProductIndex > -1) {
                productsInCurrentOrder[existingProductIndex].quantity += quantity;
                productsInCurrentOrder[existingProductIndex].totalM3 = (productInfo.cubageUnit * productsInCurrentOrder[existingProductIndex].quantity);
                productsInCurrentOrder[existingProductIndex].totalValue = (productInfo.tableValue * productsInCurrentOrder[existingProductIndex].quantity);
                displayAddProductMessage(translations[currentLanguage]['quantityUpdated'](productInfo.description, productsInCurrentOrder[existingProductIndex].quantity), 'success');
            } else {
                productsInCurrentOrder.push({
                    clientCode: clientProductCode,
                    code: productCode,
                    name: productInfo.description,
                    quantity: quantity,
                    moq: productInfo.moq,
                    unitPrice: productInfo.unitPrice,
                    tableValue: productInfo.tableValue,
                    cubageUnit: productInfo.cubageUnit,
                    totalM3: totalM3,
                    totalValue: totalValue,
                    supplier: productInfo.supplier,
                    simulatedStock: productInfo.simulatedStock,
                    originCountry: productInfo.originCountry,
                    selectedBranch: productInfo.originCountry,
                    productLine: productInfo.productLine
                });
                displayAddProductMessage(translations[currentLanguage]['productAdded'](productInfo.description), 'success');
            }

            renderProductList();
            document.getElementById('clientProductCode').value = '';
            document.getElementById('mappedProductCodeDisplay').value = '--';
            document.getElementById('productDescriptionDisplay').value = '--';
            document.getElementById('productQuantity').value = '1';
            document.getElementById('productValueDisplay').value = '$ 0,00';
            document.getElementById('totalM3Display').value = '0.00 m¬≥';
            document.getElementById('valorTotalDisplay').value = '$ 0,00'; // Corrigido para moeda
            document.getElementById('productStockDisplay').value = '--';
            document.getElementById('validationFeedback').innerText = '';
            document.getElementById('productStockDisplay').style.color = '';
            updateManualProductFieldsVisibility('');
        }

        /**
         * Remove um produto da lista de produtos do pedido atual.
         * @param {number} index - √çndice do produto a ser removido.
         */
        function removeProduct(index) {
            if (index >= 0 && index < productsInCurrentOrder.length) {
                productsInCurrentOrder.splice(index, 1);
                renderProductList();
                displayAddProductMessage(translations[currentLanguage]['productRemoved'], 'info');
            } else {
                displayAddProductMessage(translations[currentLanguage]['invalidProductIndex'], 'error');
            }
        }

        /**
         * Atualiza a quantidade de um produto na lista.
         * @param {number} index - √çndice do produto.
         * @param {string} newQuantity - Nova quantidade.
         */
        function updateProductQuantityInList(index, newQuantity) {
            const product = productsInCurrentOrder[index];
            const productInfoFromDB = productDatabase[product.code];
            const oldQuantity = product.quantity;
            const quantity = parseInt(newQuantity);

            if (isNaN(quantity) || quantity <= 0) {
                product.quantity = oldQuantity;
                renderProductList();
                displayAddProductMessage(translations[currentLanguage]['invalidQuantityInput'], 'error');
                return;
            }

            product.quantity = quantity;
            product.totalM3 = (productInfoFromDB.cubageUnit * quantity);
            product.totalValue = (productInfoFromDB.tableValue * quantity);

            let validationMessage = '';
            let messageType = 'info';

            if (product.selectedBranch === 'Hong Kong') {
                if (quantity < productInfoFromDB.moq) {
                    validationMessage = translations[currentLanguage]['qtyBelowMOQWarning'](quantity, productInfoFromDB.moq);
                    messageType = 'warning';
                } else {
                    validationMessage = translations[currentLanguage]['qtyMeetsMOQSuccess'](quantity, productInfoFromDB.moq);
                    messageType = 'success';
                }
            } else if (product.selectedBranch === 'Col√¥mbia') {
                if (quantity > productInfoFromDB.simulatedStock) {
                    validationMessage = translations[currentLanguage]['qtyExceedsStockError'](quantity, productInfoFromDB.simulatedStock);
                    messageType = 'error';
                } else {
                    validationMessage = translations[currentLanguage]['qtyAvailableStockSuccess'](quantity);
                    messageType = 'success';
                }
            }
            displayAddProductMessage(validationMessage, messageType);
            renderProductList();
        }

        /**
         * Atualiza a filial selecionada para um produto.
         * @param {number} index - √çndice do produto.
         * @param {string} newBranch - Nova filial selecionada.
         */
        function updateProductSelectedBranch(index, newBranch) {
            productsInCurrentOrder[index].selectedBranch = newBranch;
            renderProductList();
        }

        /**
         * Renderiza a lista de produtos adicionados.
         */
        function renderProductList() {
            const listDiv = document.getElementById('productList');
            listDiv.innerHTML = `<h3 class="font-semibold text-gray-700 mb-2">${translations[currentLanguage]['productsAddedToRequestTitle']}</h3>`;
            if (productsInCurrentOrder.length === 0) {
                listDiv.innerHTML += `<div id="noProductsAdded" class="text-gray-500 text-center py-4">${translations[currentLanguage]['noProductsAdded']}</div>`;
                return;
            }

            let tableHtml = `<div class="table-container">
                                <table class="data-table" id="addedProductsTable">
                                    <thead>
                                        <tr>
                                            <th>${translations[currentLanguage]['catalogClientProductCode']}</th>
                                            <th>${translations[currentLanguage]['catalogProductCode']}</th>
                                            <th>${translations[currentLanguage]['catalogDescription']}</th>
                                            <th>${translations[currentLanguage]['colQuantity']}</th>
                                            <th class="colombia-col">${translations[currentLanguage]['columbiaStock']}</th>
                                            <th class="hongkong-col">${translations[currentLanguage]['hongKongMOQContainer']}</th>
                                            <th>${translations[currentLanguage]['selectedBranch']}</th>
                                            <th>${translations[currentLanguage]['action']}</th>
                                        </tr>
                                    </thead>
                                    <tbody>`;

            productsInCurrentOrder.forEach((product, index) => {
                const productInfoFromDB = productDatabase[product.code];

                const columbiaStockStatus = productInfoFromDB.simulatedStock > 0 ? translations[currentLanguage]['yes'] : translations[currentLanguage]['no'];
                const columbiaStockColor = productInfoFromDB.simulatedStock > 0 ? 'var(--green-success)' : 'var(--red-alert)';

                const hongKongMOQ = productInfoFromDB.moq;

                let rowClass = '';
                if (product.selectedBranch === 'Hong Kong' && product.quantity < hongKongMOQ) rowClass = 'needs-review';
                else if (product.selectedBranch === 'Col√¥mbia' && product.quantity > productInfoFromDB.simulatedStock) rowClass = 'needs-review';

                tableHtml += `
                    <tr class="${rowClass}">
                        <td>${product.clientCode}</td>
                        <td>${product.code}</td>
                        <td>${product.name}</td>
                        <td>
                            <input type="number" value="${product.quantity}" min="1"
                                onchange="updateProductQuantityInList(${index}, this.value)"
                                class="w-20 text-center border rounded-md px-2 py-1 text-sm">
                        </td>
                        <td class="colombia-col" style="color: ${columbiaStockColor}; font-weight: bold;">${columbiaStockStatus}</td>
                        <td class="hongkong-col">${hongKongMOQ}</td>
                        <td>
                            <select onchange="updateProductSelectedBranch(${index}, this.value)"
                                class="border rounded-md px-2 py-1 text-sm">
                                <option value="Col√¥mbia" ${product.selectedBranch === 'Col√¥mbia' ? 'selected' : ''}>${translations[currentLanguage]['colombiaBranchTitle']}</option>
                                <option value="Hong Kong" ${product.selectedBranch === 'Hong Kong' ? 'selected' : ''}>${translations[currentLanguage]['hongKongBranchTitle']}</option>
                            </select>
                        </td>
                        <td><button onclick="removeProduct(${index})" class="remove-item-btn">${translations[currentLanguage]['remove']}</button></td>
                    </tr>
                `;
            });
            tableHtml += `</tbody></table></div>`;
            listDiv.innerHTML += tableHtml;
        }

        /**
         * Envia o formul√°rio de pedido, validando os produtos e dividindo-os por filial.
         */
        function submitOrderForm() {
            if (productsInCurrentOrder.length === 0) {
                showMessage(translations[currentLanguage]['errorTitle'] || 'Erro', translations[currentLanguage]['addAtLeastOneProduct'], 'error');
                return;
            }

            let validationErrors = [];
            productsInCurrentOrder.forEach(product => {
                const productInfoFromDB = productDatabase[product.code];
                if (product.selectedBranch === 'Hong Kong') {
                    if (product.quantity < productInfoFromDB.moq) {
                        validationErrors.push(translations[currentLanguage]['qtyBelowMOQWarning'](product.quantity, productInfoFromDB.moq));
                    }
                } else if (product.selectedBranch === 'Col√¥mbia') {
                    if (product.quantity > productInfoFromDB.simulatedStock) {
                        validationErrors.push(translations[currentLanguage]['qtyExceedsStockError'](product.quantity, productInfoFromDB.simulatedStock));
                    }
                }
            });

            if (validationErrors.length > 0) {
                showMessage(translations[currentLanguage]['validationErrorsTitle'], validationErrors.join('<br>'), 'error');
                renderProductList();
                return;
            }

            currentParentOrderId = `SOL-${nextParentRequestCounter.toString().padStart(3, '0')}`;
            nextParentRequestCounter++;

            const productsBySelectedBranch = productsInCurrentOrder.reduce((acc, product) => {
                if (!acc[product.selectedBranch]) acc[product.selectedBranch] = [];
                acc[product.selectedBranch].push(product);
                return acc;
            }, {});

            simulatedSupplierOrders = {};
            simulatedColombiaOrder = null;

            for (const branch in productsBySelectedBranch) {
                const productsForThisBranch = productsBySelectedBranch[branch];
                if (branch === 'Hong Kong') submitHongKongFormLogic(productsForThisBranch);
                else if (branch === 'Col√¥mbia') submitColombiaFormLogic(productsForThisBranch);
            }

            showScreen('summaryScreen');
            renderUnifiedSummary();

            productsInCurrentOrder = [];
            synchronizeOrdersAndPOs();
        }

        /**
         * L√≥gica de submiss√£o para pedidos de Hong Kong.
         * @param {Array<Object>} productsForHongKong - Produtos destinados a Hong Kong.
         */
        function submitHongKongFormLogic(productsForHongKong) {
            let moqMessages = [];
            let validProductsAfterMoq = [];

            productsForHongKong.forEach(product => {
                if (product.quantity < product.moq) {
                    moqMessages.push(translations[currentLanguage]['qtyBelowMOQWarning'](product.quantity, product.moq));
                } else {
                    validProductsAfterMoq.push(product);
                }
            });

            if (validProductsAfterMoq.length === 0) {
                if (moqMessages.length > 0) simulatedSupplierOrders['MOQ_FAILED'] = { messages: moqMessages };
                return;
            }

            const productsBySupplier = validProductsAfterMoq.reduce((acc, product) => {
                if (!acc[product.supplier]) acc[product.supplier] = [];
                acc[product.supplier].push(product);
                return acc;
            }, {});

            for (const supplierName in productsBySupplier) {
                const productsForThisSupplier = productsBySupplier[supplierName];
                const poId = `PED-${nextPurchaseOrderIdCounter.toString().padStart(3, '0')}`;
                nextPurchaseOrderIdCounter++;

                const newPO = {
                    id: poId,
                    parentOrderId: currentParentOrderId,
                    supplier: supplierName,
                    supplierCode: getOrGenerateSupplierCode(supplierName),
                    date: new Date().toISOString().slice(0, 10),
                    products: [],
                    newSupplierPriceTotal: 0,
                    currentInternalPriceTotal: 0,
                    overallApprovalStatus: 'Pendente',
                    originCountry: 'Hong Kong',
                    totalCubage: 0
                };

                productsForThisSupplier.forEach(product => {
                    const productWithSimulatedPrices = { ...product };
                    productWithSimulatedPrices.currentInternalUnitPrice = (product.tableValue + Math.random() * 5).toFixed(2);
                    productWithSimulatedPrices.newSupplierUnitPrice = (product.unitPrice * (1 + (Math.random() * 0.05))).toFixed(2);
                    newPO.products.push(productWithSimulatedPrices);
                    newPO.newSupplierPriceTotal = (parseFloat(newPO.newSupplierPriceTotal) + (parseFloat(productWithSimulatedPrices.newSupplierUnitPrice) * product.quantity)).toFixed(2);
                    newPO.currentInternalPriceTotal = (parseFloat(newPO.currentInternalPriceTotal) + (parseFloat(productWithSimulatedPrices.currentInternalUnitPrice) * product.quantity)).toFixed(2);
                    newPO.totalCubage = (parseFloat(newPO.totalCubage) + (product.cubageUnit * product.quantity));
                });
                newPO.totalCubage = newPO.totalCubage.toFixed(2);
                simulatedSupplierOrders[supplierName] = newPO;
            }
            if (moqMessages.length > 0) simulatedSupplierOrders['MOQ_INFO'] = { messages: moqMessages };
        }

        /**
         * L√≥gica de submiss√£o para pedidos da Col√¥mbia.
         * @param {Array<Object>} productsForColombia - Produtos destinados √† Col√¥mbia.
         */
        function submitColombiaFormLogic(productsForColombia) {
            const totalValue = productsForColombia.reduce((sum, product) => sum + (product.tableValue * product.quantity), 0);
            const totalCubageColombia = productsForColombia.reduce((sum, product) => sum + (product.cubageUnit * product.quantity), 0);

            const newOrderId = `SAP-${nextSapOrderIdCounter.toString().padStart(3, '0')}`;
            nextSapOrderIdCounter++;

            simulatedColombiaOrder = {
                orderId: newOrderId,
                parentOrderId: currentParentOrderId,
                clientFlag: currentUserClientName,
                originCountry: 'Col√¥mbia',
                totalValue: totalValue,
                status: 'Em Separa√ß√£o',
                requestDate: new Date().toISOString().slice(0, 10),
                lastUpdateDate: new Date().toISOString().slice(0, 10),
                supplier: productsForColombia[0].supplier,
                products: productsForColombia.map(p => ({
                    code: p.code,
                    description: p.name,
                    quantity: p.quantity,
                    unitPrice: p.tableValue,
                    cubageUnit: p.cubageUnit,
                    totalValue: (p.tableValue * p.quantity),
                    productLine: productDatabase[p.code].productLine
                })),
                totalCubage: totalCubageColombia.toFixed(2)
            };
        }

        /**
         * Sugere o tipo de cont√™iner com base na cubagem total.
         * @param {number} totalCubage - Cubagem total em m¬≥.
         * @returns {string} Sugest√£o de cont√™iner.
         */
        function getContainerSuggestion(totalCubage) {
            if (totalCubage <= 0) return "N/A";
            if (totalCubage <= LCL_CAPACITY) return "1 X LCL";
            else if (totalCubage <= MAX_CUBAGE_20HC) return "1 X CTN 20";
            else if (totalCubage <= MAX_CUBAGE_40HC_CU) return "1 X CTN 40HC";
            else {
                const num40HC = Math.ceil(totalCubage / MAX_CUBAGE_40HC_CU);
                return `${num40HC} X CTN 40HC`;
            }
        }

        /**
         * Obt√©m a capacidade total de um cont√™iner com base na sugest√£o.
         * @param {string} suggestion - Sugest√£o de cont√™iner (ex: "1 X LCL").
         * @returns {number} Capacidade total em m¬≥.
         */
        function getCapacityFromContainerSuggestion(suggestion) {
            if (suggestion.includes('LCL')) return LCL_CAPACITY;
            else if (suggestion.includes('CTN 20')) return MAX_CUBAGE_20HC;
            else if (suggestion.includes('CTN 40HC')) {
                const match = suggestion.match(/(\d+)\s*X\s*CTN 40HC/);
                if (match && match[1]) return parseInt(match[1]) * MAX_CUBAGE_40HC_CU;
                return MAX_CUBAGE_40HC_CU;
            }
            return 0;
        }

        /**
         * Renderiza o resumo unificado da solicita√ß√£o (Hong Kong e Col√¥mbia).
         */
        function renderUnifiedSummary() {
            const unifiedSummaryContentDiv = document.getElementById('unifiedSummaryContent');
            unifiedSummaryContentDiv.innerHTML = '';

            if (Object.keys(simulatedSupplierOrders).length > 0) {
                const hongKongSection = document.createElement('div');
                hongKongSection.className = 'summary-section';
                hongKongSection.innerHTML = `<h2 class="text-xl font-semibold mb-4">${translations[currentLanguage]['hongKongOrdersTitle']}</h2>`;

                if (simulatedSupplierOrders['MOQ_INFO'] && simulatedSupplierOrders['MOQ_INFO'].messages.length > 0) {
                    const moqValidationDiv = document.createElement('div');
                    moqValidationDiv.className = 'bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-4';
                    moqValidationDiv.innerHTML = `<p class="font-bold">${translations[currentLanguage]['moqAttention']}</p>${simulatedSupplierOrders['MOQ_INFO'].messages.map(msg => `<p>${msg}</p>`).join('')}`;
                    hongKongSection.appendChild(moqValidationDiv);
                }
                if (simulatedSupplierOrders['MOQ_FAILED'] && simulatedSupplierOrders['MOQ_FAILED'].messages.length > 0) {
                    const moqFailedDiv = document.createElement('div');
                    moqFailedDiv.className = 'bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4';
                    moqFailedDiv.innerHTML = `<p class="font-bold">${translations[currentLanguage]['moqError']}</p>${simulatedSupplierOrders['MOQ_FAILED'].messages.map(msg => `<p>${msg}</p>`).join('')}`;
                    hongKongSection.appendChild(moqFailedDiv);
                }

                hongKongSection.innerHTML += `<h3 class="font-semibold text-gray-700 mb-3">${translations[currentLanguage]['supplierDivisionTitle']}</h3>`;

                for (const supplierName in simulatedSupplierOrders) {
                    if (supplierName === 'MOQ_INFO' || supplierName === 'MOQ_FAILED') continue;

                    const po = simulatedSupplierOrders[supplierName];
                    const poDiv = document.createElement('div');
                    poDiv.className = 'supplier-summary-card';

                    const totalCubage = parseFloat(po.totalCubage || 0);
                    const percentageOccupationLCL = (totalCubage / LCL_CAPACITY) * 100;
                    const percentageOccupation20HC = (totalCubage / MAX_CUBAGE_20HC) * 100;
                    const percentageOccupation40HC_CU = (totalCubage / MAX_CUBAGE_40HC_CU) * 100;

                    let cardStatusEmoji = '';
                    if (po.overallApprovalStatus === 'Aguardando Aprova√ß√£o') cardStatusEmoji = 'üü°';
                    else if (po.overallApprovalStatus === 'Aprovado') cardStatusEmoji = 'üü¢';
                    else if (po.overallApprovalStatus === 'Rejeitado') cardStatusEmoji = 'üî¥';
                    else if (po.overallApprovalStatus === 'Negociado') cardStatusEmoji = 'üü£';
                    else if (po.overallApprovalStatus === 'Finalizado') cardStatusEmoji = '‚úÖ';

                    const containerSuggestion = getContainerSuggestion(totalCubage);
                    const predictedContainerCapacity = getCapacityFromContainerSuggestion(containerSuggestion);

                    poDiv.innerHTML = `
                        <span class="supplier-status-indicator">${cardStatusEmoji}</span>
                        <h4 class="font-semibold text-lg mb-2">${translations[currentLanguage]['poNumberForSupplier'](po.id, po.supplierCode, po.supplier)}</h4>
                        <p class="text-gray-600 mb-1">${translations[currentLanguage]['mainRequestId']} <strong>${po.parentOrderId}</strong></p>
                        <p class="text-gray-600 mb-1">${translations[currentLanguage]['generationDate']} ${po.date}</p>
                        <p class="text-gray-600 mb-4">${translations[currentLanguage]['estimatedOrderTotal']} <strong>$ ${parseFloat(po.newSupplierPriceTotal).toFixed(2).replace('.', ',')}</strong></p>
                        <p class="text-gray-600 mb-4">${translations[currentLanguage]['containerForecast']} <strong>${containerSuggestion}</strong></p>

                        <h5 class="font-semibold text-md mb-2">${translations[currentLanguage]['products']}</h5>
                        <div class="overflow-x-auto">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>${translations[currentLanguage]['colModel']}</th>
                                        <th>${translations[currentLanguage]['colProductCode']}</th>
                                        <th>${translations[currentLanguage]['colDescription']}</th>
                                        <th>${translations[currentLanguage]['colQuantity']}</th>
                                        <th>${translations[currentLanguage]['colUnitPrice']}</th>
                                        <th>${translations[currentLanguage]['colTotalPrice']}</th>
                                        <th>${translations[currentLanguage]['colM3Unit']}</th>
                                        <th>${translations[currentLanguage]['colM3Total']}</th>
                                        <th>${translations[currentLanguage]['colContainerPercentage']}</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${po.products.map(p => {
                                        const productInfo = productDatabase[p.code];
                                        const totalM3Item = (productInfo.cubageUnit * p.quantity);
                                        const percentageContainer = predictedContainerCapacity > 0 ? (totalM3Item / predictedContainerCapacity) * 100 : 0;
                                        const unitPriceDisplay = parseFloat(p.newSupplierUnitPrice).toFixed(2).replace('.', ',');
                                        const totalPriceItem = (parseFloat(p.newSupplierUnitPrice) * p.quantity).toFixed(2).replace('.', ',');

                                        return `
                                        <tr>
                                            <td>${productInfo.productLine || 'N/A'}</td>
                                            <td>${p.code}</td>
                                            <td>${p.name}</td>
                                            <td>${p.quantity}</td>
                                            <td>$ ${unitPriceDisplay}</td>
                                            <td>$ ${totalPriceItem}</td>
                                            <td>${productInfo.cubageUnit.toFixed(3).replace('.', ',')} m¬≥</td>
                                            <td>${totalM3Item.toFixed(2).replace('.', ',')} m¬≥</td>
                                            <td>${percentageContainer.toFixed(2).replace('.', ',')}%</td>
                                        </tr>
                                    `;
                                    }).join('')}
                                </tbody>
                            </table>
                        </div>

                        <h5 class="font-semibold text-md mb-2 mt-4">${translations[currentLanguage]['cubageForecastTitle']}</h5>
                        <p class="text-sm text-gray-700 mb-2">${translations[currentLanguage]['totalOrderCubage'](totalCubage.toFixed(2).replace('.', ','))}</p>
                        <table class="cubage-table">
                            <thead>
                                <tr>
                                    <th>${translations[currentLanguage]['containerType']}</th>
                                    <th>${translations[currentLanguage]['occupationPercentage']}</th>
                                    <th>${translations[currentLanguage]['totalM3CTN']}</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="${containerSuggestion.includes('LCL') ? 'highlight-container' : ''}">
                                    <td>LCL</td>
                                    <td>${percentageOccupationLCL.toFixed(2).replace('.', ',')}%</td>
                                    <td>-</td>
                                </tr>
                                <tr class="${containerSuggestion.includes('CTN 20') ? 'highlight-container' : ''}">
                                    <td>CTN 20</td>
                                    <td>${percentageOccupation20HC.toFixed(2).replace('.', ',')}%</td>
                                    <td>${MAX_CUBAGE_20HC.toFixed(2).replace('.', ',')} m¬≥</td>
                                </tr>
                                <tr class="${containerSuggestion.includes('CTN 40HC') ? 'highlight-container' : ''}">
                                    <td>CTN 40HC</td>
                                    <td>${percentageOccupation40HC_CU.toFixed(2).replace('.', ',')}%</td>
                                    <td>${MAX_CUBAGE_40HC_CU.toFixed(2).replace('.', ',')} m¬≥</td>
                                </tr>
                            </tbody>
                        </table>
                        <p class="disclaimer-text">${translations[currentLanguage]['priceDisclaimer']}</p>
                    `;
                    hongKongSection.appendChild(poDiv);
                }
                unifiedSummaryContentDiv.appendChild(hongKongSection);
            }

            if (simulatedColombiaOrder) {
                const colombiaSection = document.createElement('div');
                colombiaSection.className = 'summary-section';
                colombiaSection.innerHTML = `
                    <h2 class="text-xl font-semibold mb-4">${translations[currentLanguage]['colombiaOrderTitle']}</h2>
                    <div class="bg-white p-6 rounded-lg shadow-md mb-6 border border-gray-200">
                        <h3 class="font-semibold text-lg mb-2">${translations[currentLanguage]['salesOrderDetailsTitle']}</h3>
                        <p class="mb-1">${translations[currentLanguage]['salesOrderNumberSAP']} <strong>${simulatedColombiaOrder.orderId}</strong></p>
                        <p class="mb-1">${translations[currentLanguage]['mainRequestId']} <strong>${simulatedColombiaOrder.parentOrderId}</strong></p>
                        <p class="mb-1">${translations[currentLanguage]['totalValue']} <strong>$ ${simulatedColombiaOrder.totalValue.toFixed(2).replace('.', ',')}</strong></p>
                        <p class="text-gray-600 mb-4">${translations[currentLanguage]['containerForecast']} <strong>${getContainerSuggestion(parseFloat(simulatedColombiaOrder.totalCubage))}</strong></p>

                        <h4 class="font-semibold text-md mb-2 mt-4">${translations[currentLanguage]['products']}</h4>
                        <div class="overflow-x-auto">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>${translations[currentLanguage]['colModel']}</th>
                                        <th>${translations[currentLanguage]['colProductCode']}</th>
                                        <th>${translations[currentLanguage]['colDescription']}</th>
                                        <th>${translations[currentLanguage]['colQuantity']}</th>
                                        <th>${translations[currentLanguage]['colUnitPrice']}</th>
                                        <th>${translations[currentLanguage]['colTotalPrice']}</th>
                                        <th>${translations[currentLanguage]['colM3Unit']}</th>
                                        <th>${translations[currentLanguage]['colM3Total']}</th>
                                        <th>${translations[currentLanguage]['colContainerPercentage']}</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${simulatedColombiaOrder.products.map(p => {
                                        const productInfo = productDatabase[p.code];
                                        const totalM3Item = (productInfo.cubageUnit * p.quantity);
                                        const containerSuggestionColombia = getContainerSuggestion(parseFloat(simulatedColombiaOrder.totalCubage));
                                        const predictedContainerCapacityColombia = getCapacityFromContainerSuggestion(containerSuggestionColombia);
                                        const percentageContainer = predictedContainerCapacityColombia > 0 ? (totalM3Item / predictedContainerCapacityColombia) * 100 : 0;

                                        const unitPriceDisplay = parseFloat(p.unitPrice).toFixed(2).replace('.', ',');
                                        const totalPriceItem = parseFloat(p.totalValue).toFixed(2).replace('.', ',');
                                        return `
                                        <tr>
                                            <td>${productInfo.productLine || 'N/A'}</td>
                                            <td>${p.code}</td>
                                            <td>${p.description}</td>
                                            <td>${p.quantity}</td>
                                            <td>$ ${unitPriceDisplay}</td>
                                            <td>$ ${totalPriceItem}</td>
                                            <td>${productInfo.cubageUnit.toFixed(3).replace('.', ',')} m¬≥</td>
                                            <td>${totalM3Item.toFixed(2).replace('.', ',')} m¬≥</td>
                                            <td>${percentageContainer.toFixed(2).replace('.', ',')}%</td>
                                        </tr>
                                    `;
                                    }).join('')}
                                </tbody>
                            </table>
                        </div>
                        <p class="disclaimer-text">${translations[currentLanguage]['priceDisclaimer']}</p>
                    </div>
                `;
                unifiedSummaryContentDiv.appendChild(colombiaSection);
            }

            if (Object.keys(simulatedSupplierOrders).length === 0 && !simulatedColombiaOrder) {
                unifiedSummaryContentDiv.innerHTML = `<p class="text-center text-gray-500">${translations[currentLanguage]['noSummaryOrders']}</p>`;
            }
        }

        /**
         * Gera as ordens unificadas e as adiciona √† lista de pedidos.
         */
        function confirmAndGenerateOrders() {
            for (const supplierName in simulatedSupplierOrders) {
                if (supplierName === 'MOQ_INFO' || supplierName === 'MOQ_FAILED') continue;
                const po = simulatedSupplierOrders[supplierName];
                const existingPoIndex = generatedPurchaseOrders.findIndex(existingPo => existingPo.id === po.id);
                if (existingPoIndex === -1) {
                    generatedPurchaseOrders.push(po);
                } else {
                    generatedPurchaseOrders[existingPoIndex] = po;
                }

                const orderInMainList = orders.find(o => o.orderId === po.id);
                if (!orderInMainList) {
                    orders.push({
                        orderId: po.id,
                        parentOrderId: po.parentOrderId,
                        clientFlag: currentUserClientName,
                        originCountry: po.originCountry,
                        totalValue: parseFloat(po.newSupplierPriceTotal),
                        status: po.overallApprovalStatus,
                        requestDate: po.date,
                        lastUpdateDate: new Date().toISOString().slice(0, 10),
                        supplier: po.supplier,
                        products: po.products.map(p => ({
                            code: p.code,
                            description: p.name,
                            quantity: p.quantity,
                            unitPrice: parseFloat(p.newSupplierUnitPrice),
                            cubageUnit: p.cubageUnit
                        })),
                        totalCubage: parseFloat(po.totalCubage)
                    });
                } else {
                    orderInMainList.status = po.overallApprovalStatus;
                    orderInMainList.lastUpdateDate = new Date().toISOString().slice(0, 10);
                    orderInMainList.totalCubage = parseFloat(po.totalCubage);
                }
            }

            if (simulatedColombiaOrder) {
                const existingColombiaOrderIndex = generatedPurchaseOrders.findIndex(existingPo => existingPo.id === simulatedColombiaOrder.orderId);
                if (existingColombiaOrderIndex === -1) {
                    generatedPurchaseOrders.push(simulatedColombiaOrder);
                } else {
                    generatedPurchaseOrders[existingColombiaOrderIndex] = simulatedColombiaOrder;
                }

                const orderInMainList = orders.find(o => o.orderId === simulatedColombiaOrder.orderId);
                if (!orderInMainList) {
                    orders.push(simulatedColombiaOrder);
                } else {
                    orderInMainList.status = simulatedColombiaOrder.status;
                    orderInMainList.lastUpdateDate = new Date().toISOString().slice(0, 10);
                    orderInMainList.totalCubage = parseFloat(simulatedColombiaOrder.totalCubage);
                }
            }

            showMessage(translations[currentLanguage]['requestSentTitle'], translations[currentLanguage]['requestSentMessage'], 'success', () => backToOrderCenter());

            simulatedSupplierOrders = {};
            simulatedColombiaOrder = null;
            synchronizeOrdersAndPOs();
        }

        /**
         * Exibe o PDF da NF-e (conte√∫do simulado).
         */
        function showNfePdfUnified() {
            if (simulatedColombiaOrder && simulatedColombiaOrder.nfeContent) {
                document.getElementById('nfePdfContent').innerText = simulatedColombiaOrder.nfeContent;
                document.getElementById('nfePdfViewer').classList.add('active');
            } else {
                showMessage(translations[currentLanguage]['errorTitle'] || 'Erro', translations[currentLanguage]['nfeContentNotAvailable'], 'error');
            }
        }

        /**
         * Sincroniza o status dos pedidos com as ordens de compra geradas.
         */
        function synchronizeOrdersAndPOs() {
            orders.forEach(order => {
                const correspondingPO = generatedPurchaseOrders.find(po => po.id === order.orderId);
                if (correspondingPO) {
                    order.status = correspondingPO.overallApprovalStatus;
                    order.lastUpdateDate = new Date().toISOString().slice(0, 10);

                    if (correspondingPO.overallApprovalStatus === 'Aprovado' && order.originCountry === 'Hong Kong') order.status = 'Em Produ√ß√£o';
                    else if (correspondingPO.overallApprovalStatus === 'Negociado') order.status = 'Em Negocia√ß√£o';
                    else if (correspondingPO.overallApprovalStatus === 'Finalizado') order.status = 'Finalizado';
                }
            });
            if (currentScreen === 'central-pedidos-page') renderOrdersTable();
        }

        /**
         * Alterna a visibilidade de um elemento colaps√°vel.
         * @param {HTMLElement} headerElement - O elemento do cabe√ßalho do acorde√£o.
         * @param {string} contentId - O ID do conte√∫do a ser colapsado/expandido.
         */
        function toggleCollapsible(headerElement, contentId) {
            const content = document.getElementById(contentId);
            const arrow = headerElement.querySelector('.arrow');
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                headerElement.classList.remove('active');
                if (arrow) arrow.style.transform = 'rotate(0deg)';
            } else {
                content.classList.add('active');
                headerElement.classList.add('active');
                if (arrow) arrow.style.transform = 'rotate(180deg)';
            }
        }

        /**
         * Abre o modal do cat√°logo de produtos.
         */
        function openProductCatalogModal() {
            const productCatalogList = document.getElementById('productCatalogList');
            productCatalogList.innerHTML = '';

            let tableHtml = `<table class="data-table">
                                <thead>
                                    <tr>
                                        <th>${translations[currentLanguage]['catalogClientProductCode']}</th>
                                        <th>${translations[currentLanguage]['catalogProductCode']}</th>
                                        <th>${translations[currentLanguage]['catalogDescription']}</th>
                                        <th>${translations[currentLanguage]['catalogDefaultBranch']}</th>
                                        <th>${translations[currentLanguage]['catalogUnitPrice']}</th>
                                        <th>${translations[currentLanguage]['catalogMOQ']}</th>
                                        <th>${translations[currentLanguage]['catalogStock']}</th>
                                        <th>${translations[currentLanguage]['catalogM3Unit']}</th>
                                        <th>${translations[currentLanguage]['catalogLine']}</th>
                                    </tr>
                                </thead>
                                <tbody>`;

            for (const code in productDatabase) {
                const product = productDatabase[code];
                const displayPrice = product.tableValue !== undefined && product.tableValue !== null
                    ? product.tableValue.toFixed(2).replace('.', ',') : 'N/A';

                const stockDisplay = product.simulatedStock > 0 ? translations[currentLanguage]['yes'] : translations[currentLanguage]['no'];
                const stockColor = product.simulatedStock > 0 ? 'var(--green-success)' : 'var(--red-alert)';

                tableHtml += `
                    <tr onclick="selectProductFromCatalog('${product.clientCode}')">
                        <td class="product-code-display">${product.clientCode}</td>
                        <td class="product-code-display">${product.code}</td>
                        <td class="product-description-display">${product.description}</td>
                        <td>${product.originCountry}</td>
                        <td>$ ${displayPrice}</td>
                        <td>${product.moq}</td>
                        <td><span style="color: ${stockColor}; font-weight: bold;">${stockDisplay}</span></td>
                        <td>${product.cubageUnit.toFixed(3).replace('.', ',')}</td>
                        <td class="product-line-display">${product.productLine}</td>
                    </tr>
                `;
            }
            tableHtml += `</tbody></table>`;
            productCatalogList.innerHTML = tableHtml;

            document.getElementById('productCatalogSearchInput').value = '';
            document.getElementById('productCatalogModal').classList.add('active');
        }

        /**
         * Filtra o cat√°logo de produtos com base no termo de busca.
         */
        function filterProductCatalog() {
            const searchTerm = document.getElementById('productCatalogSearchInput').value.toLowerCase();
            const rows = document.querySelectorAll('#productCatalogList tbody tr');

            rows.forEach(row => {
                const clientCode = row.children[0].innerText.toLowerCase();
                const productCode = row.children[1].innerText.toLowerCase();
                const description = row.children[2].innerText.toLowerCase();
                const branch = row.children[3].innerText.toLowerCase();

                if (clientCode.includes(searchTerm) || productCode.includes(searchTerm) || description.includes(searchTerm) || branch.includes(searchTerm)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        /**
         * Seleciona um produto do cat√°logo e preenche os campos do formul√°rio.
         * @param {string} clientProductCode - C√≥digo do produto do cliente.
         */
        function selectProductFromCatalog(clientProductCode) {
            document.getElementById('clientProductCode').value = clientProductCode;
            updateProductDetailsOnClientCodeChange();
            closeProductCatalogModal();
        }

        /**
         * Lida com o upload de arquivos de planilha.
         */
        function handleFileUpload() {
            const fileInput = document.getElementById('fileUpload');
            const fileNameDisplay = document.getElementById('fileNameDisplay');
            const file = fileInput.files[0];
            const maxFileSize = 5 * 1024 * 1024;

            if (!file) {
                displayAddProductMessage(translations[currentLanguage]['uploadFileSelect'], 'error');
                return;
            }

            const allowedTypes = ['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel', 'text/csv'];
            if (!allowedTypes.includes(file.type)) {
                displayAddProductMessage(translations[currentLanguage]['invalidFileType'], 'error');
                fileInput.value = '';
                fileNameDisplay.innerText = translations[currentLanguage]['noFileSelected'];
                return;
            }

            if (file.size > maxFileSize) {
                displayAddProductMessage(translations[currentLanguage]['fileSizeExceeded'], 'error');
                fileInput.value = '';
                fileNameDisplay.innerText = translations[currentLanguage]['noFileSelected'];
                return;
            }

            // Simula√ß√£o de leitura de planilha (substituiria a l√≥gica real de leitura de arquivo)
            const dummyProducts = [
                { clientCode: "SKU-001", quantity: 10 },
                { clientCode: "SKU-003", quantity: 25 },
                { clientCode: "SKU-007", quantity: 2 }
            ];

            let productsAddedCount = 0;
            let productsSkippedCount = 0;
            let messages = [];

            dummyProducts.forEach(item => {
                const productCode = universalClientCodeToProductCodeMap[item.clientCode.toUpperCase()];
                const productInfo = productDatabase[productCode];

                if (productInfo) {
                    const existingProductIndex = productsInCurrentOrder.findIndex(p => p.code === productCode);
                    const totalM3 = (productInfo.cubageUnit * item.quantity);
                    const totalValue = (productInfo.tableValue * item.quantity);

                    if (existingProductIndex > -1) {
                        productsInCurrentOrder[existingProductIndex].quantity += item.quantity;
                        productsInCurrentOrder[existingProductIndex].totalM3 = (productInfo.cubageUnit * productsInCurrentOrder[existingProductIndex].quantity);
                        productsInCurrentOrder[existingProductIndex].totalValue = (productInfo.tableValue * productsInCurrentOrder[existingProductIndex].quantity);
                        messages.push(translations[currentLanguage]['quantityUpdated'](productInfo.description, productsInCurrentOrder[existingProductIndex].quantity));
                    } else {
                        productsInCurrentOrder.push({
                            clientCode: item.clientCode,
                            code: productCode,
                            name: productInfo.description,
                            quantity: item.quantity,
                            moq: productInfo.moq,
                            unitPrice: productInfo.unitPrice,
                            tableValue: productInfo.tableValue,
                            cubageUnit: productInfo.cubageUnit,
                            totalM3: totalM3,
                            totalValue: totalValue,
                            supplier: productInfo.supplier,
                            simulatedStock: productInfo.simulatedStock,
                            originCountry: productInfo.originCountry,
                            selectedBranch: productInfo.originCountry,
                            productLine: productInfo.productLine
                        });
                        productsAddedCount++;
                        messages.push(translations[currentLanguage]['productAdded'](productInfo.description));
                    }
                } else {
                    messages.push(translations[currentLanguage]['invalidFormatOrProduct'](item.clientCode));
                    productsSkippedCount++;
                }
            });

            renderProductList();
            fileInput.value = '';
            fileNameDisplay.innerText = translations[currentLanguage]['noFileSelected'];

            displayAddProductMessage(translations[currentLanguage]['uploadSuccess'](file.name, productsAddedCount, productsSkippedCount), productsSkippedCount > 0 ? 'warning' : 'success');
        }

        /**
         * Exibe o nome do arquivo selecionado.
         * @param {string} inputId - ID do input de arquivo.
         * @param {string} displayId - ID do elemento onde o nome do arquivo ser√° exibido.
         */
        function displayFileName(inputId, displayId) {
            const fileInput = document.getElementById(inputId);
            const fileNameDisplay = document.getElementById(displayId);
            if (fileInput.files.length > 0) {
                fileNameDisplay.innerText = fileInput.files[0].name;
            } else {
                fileNameDisplay.innerText = translations[currentLanguage]['noFileSelected'];
            }
        }

        /**
         * Processa c√≥digos e quantidades colados na √°rea de texto.
         */
        function processPastedCodes() {
            const pasteCodesTextarea = document.getElementById('pasteCodes');
            const pastedText = pasteCodesTextarea.value.trim();

            if (!pastedText) {
                displayAddProductMessage(translations[currentLanguage]['pasteCodesEmpty'], 'error');
                return;
            }

            const normalizedText = pastedText.replace(/\n/g, ';');
            const items = normalizedText.split(';').map(item => item.trim()).filter(item => item !== '');

            let productsAddedCount = 0;
            let productsSkippedCount = 0;
            let messages = [];

            items.forEach(itemString => {
                const parts = itemString.split(',');
                if (parts.length === 2) {
                    const clientCode = parts[0].trim().toUpperCase();
                    const quantity = parseInt(parts[1].trim());

                    const productCode = universalClientCodeToProductCodeMap[clientCode];
                    const productInfo = productDatabase[productCode];

                    if (productInfo && !isNaN(quantity) && quantity > 0) {
                        const existingProductIndex = productsInCurrentOrder.findIndex(p => p.code === productCode);
                        const totalM3 = (productInfo.cubageUnit * quantity);
                        const totalValue = (productInfo.tableValue * quantity);

                        if (existingProductIndex > -1) {
                            productsInCurrentOrder[existingProductIndex].quantity += quantity;
                            productsInCurrentOrder[existingProductIndex].totalM3 = (productInfo.cubageUnit * productsInCurrentOrder[existingProductIndex].quantity);
                            productsInCurrentOrder[existingProductIndex].totalValue = (productInfo.tableValue * productsInCurrentOrder[existingProductIndex].quantity);
                            messages.push(translations[currentLanguage]['quantityUpdated'](productInfo.description, productsInCurrentOrder[existingProductIndex].quantity));
                        } else {
                            productsInCurrentOrder.push({
                                clientCode: clientCode,
                                code: productCode,
                                name: productInfo.description,
                                quantity: quantity,
                                moq: productInfo.moq,
                                unitPrice: productInfo.unitPrice,
                                tableValue: productInfo.tableValue,
                                cubageUnit: productInfo.cubageUnit,
                                totalM3: totalM3,
                                totalValue: totalValue,
                                supplier: productInfo.supplier,
                                simulatedStock: productInfo.simulatedStock,
                                originCountry: productInfo.originCountry,
                                selectedBranch: productInfo.originCountry,
                                productLine: productInfo.productLine
                            });
                            productsAddedCount++;
                            messages.push(translations[currentLanguage]['productAdded'](productInfo.description));
                        }
                    } else {
                        messages.push(translations[currentLanguage]['invalidFormatOrProduct'](itemString));
                        productsSkippedCount++;
                    }
                } else {
                    messages.push(translations[currentLanguage]['expectedFormat'](itemString));
                    productsSkippedCount++;
                }
            });

            renderProductList();
            pasteCodesTextarea.value = '';

            displayAddProductMessage(translations[currentLanguage]['codesProcessedSuccess'](productsAddedCount, productsSkippedCount), productsSkippedCount > 0 ? 'warning' : 'success');
        }

        /**
         * Baixa o modelo de planilha CSV.
         */
        function downloadSpreadsheetModel() {
            const csvContent = "data:text/csv;charset=utf-8,CodigoCliente,Quantidade\nSKU-001,10\nSKU-003,5\n";
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "modelo_planilha_fluig.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            displayAddProductMessage(translations[currentLanguage]['spreadsheetModelDownloaded'], 'success');
        }

        /**
         * Abre o modal do fluxograma.
         */
        function openFlowchartModal() {
            document.getElementById('flowchartModal').classList.add('active');
        }

        /**
         * Fecha o modal do fluxograma.
         */
        function closeFlowchartModal() {
            document.getElementById('flowchartModal').classList.remove('active');
        }

        // Inicializa√ß√£o da aplica√ß√£o ao carregar o DOM
        document.addEventListener('DOMContentLoaded', () => {
            // Garante que os c√≥digos de fornecedor simulados sejam gerados
            orders.forEach(order => {
                if (order.supplier) getOrGenerateSupplierCode(order.supplier);
            });

            // Define o idioma padr√£o e atualiza a interface
            setLanguage('pt-BR');
            // document.getElementById('language-selector').value = 'pt-BR'; // This is now handled by the loop in setLanguage

            // Popula os filtros e renderiza a tabela inicial
            populateSupplierFilter();
            populateOriginCountryFilter();
            renderOrdersTable();

            // Adiciona listeners de evento aos bot√µes principais
            document.getElementById('novaSolicitacao').addEventListener('click', () => {
                showScreen('newOrderFormScreen');
                resetNewOrderForm();
            });

            document.getElementById('logoutButton').addEventListener('click', logout);
            document.getElementById('messageModalCloseBtn').addEventListener('click', () => {
                document.getElementById('messageModal').classList.remove('active');
            });
        });
    </script>
</body>
</html>
